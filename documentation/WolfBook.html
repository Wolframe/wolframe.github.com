<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Wolframe documentation</title><link rel="stylesheet" type="text/css" href="wolframe.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><style type="text/css">
body { background-image: url('images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style></head><body><div class="set" lang="en" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="idp1393144772"></a>Wolframe documentation</h1></div><div><p class="copyright">Copyright © 2010 - 2013 Project Wolframe</p></div><div><p class="pubdate">October 31, 2013
</p></div></div><hr /></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="book"><a href="#book_AppDevelopment">WAD</a></span></dt><dd><dl><dt><span class="preface"><a href="#idp1393189348">Foreword</a></span></dt><dt><span class="chapter"><a href="#idp1393804268">1. Introduction</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1393804612">1.1. Introduction to Service Development</a></span></dt><dt><span class="sect1"><a href="#idp1393212364">1.2. Architecture</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1393215244">1.2.1. Presentation tier</a></span></dt><dt><span class="sect2"><a href="#idp1393216588">1.2.2. Logic tier</a></span></dt><dt><span class="sect2"><a href="#idp1393221476">1.2.3. Data tier</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1393170532">2. Command Handler</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1396487940">2.1. The Standard Command Handler</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396488260">2.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1393168668">2.1.2. Example Configuration</a></span></dt><dt><span class="sect2"><a href="#idp1396523956">2.1.3. Example Command Description</a></span></dt><dt><span class="sect2"><a href="#idp1396526476">2.1.4. Command Description Language</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396544932">Overview</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1396568940">3. Functions</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1396613308">3.1. Functions in Transaction Definition Language (TDL)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396613684">3.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396649100">3.1.2. Examples</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396649420">First Example</a></span></dt><dt><span class="sect3"><a href="#idp1396651380">Preprocessing Input</a></span></dt><dt><span class="sect3"><a href="#idp1396653004">Using Variables</a></span></dt><dt><span class="sect3"><a href="#idp1396654684">Subroutines</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1396656292">3.1.3. Language Description</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396657060">Subroutines</a></span></dt><dt><span class="sect3"><a href="#idp1396659180">Transaction Function Declarations</a></span></dt><dt><span class="sect3"><a href="#idp1396666036">Main Processing Instructions</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396671948">Main Processing Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396673660">Preprocessing Instructions</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396677276">Preprocessing Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396678948">Selector Path</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396683988">Path Expression Examples</a></span></dt><dt><span class="sect4"><a href="#idp1396689268">Path Usage Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396690932">Referencing Database Results</a></span></dt><dt><span class="sect3"><a href="#idp1396696260">Naming Database Results</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396697684">Named Result Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396699236">Referencing Subroutine Parameters</a></span></dt><dt><span class="sect3"><a href="#idp1396701396">Constraints on database results</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396704684">Example with Result Constraints</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396706380">Rewriting Error Messages for the Client</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396708124">Database Error HINT Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396710700">Substructures in the Result</a></span></dt><dt><span class="sect3"><a href="#idp1396713316">Explicit Definition of Elements in the Result</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#idp1396760404">3.2. Functions in .NET</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396760724">3.2.1. Introduction</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396752700">3.3. Functions in Python</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396753044">3.3.1. Introduction</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396760172">3.4. Functions in Lua</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396759028">3.4.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396812700">3.4.2. Declaring Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396814988">3.4.3. Wolframe Provider Library</a></span></dt><dt><span class="sect2"><a href="#idp1396819060">3.4.4. Wolframe Global Objects</a></span></dt><dt><span class="sect2"><a href="#idp1396822100">3.4.5. Using Forms</a></span></dt><dt><span class="sect2"><a href="#idp1396829220">3.4.6. Form Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396834220">3.4.7. List of <span class="application">Lua</span> Objects</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396896364">3.5. DDL Data Types</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396896708">3.5.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396885620">3.5.2. Example</a></span></dt><dt><span class="sect2"><a href="#idp1396929708">3.5.3. Language Description</a></span></dt><dt><span class="sect2"><a href="#idp1396932324">3.5.4. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396893860">3.6. Functions in C++</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396894204">3.6.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396895892">3.6.2. Declaring Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396890572">3.6.3. Input/Output Data Structures</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1397053844">4. Forms</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397100548">4.1. Form Data Definition Languages</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397100868">4.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397091228">4.1.2. Forms in Simpleform DDL</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1397124932">5. Filters</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397167828">5.1. XML Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397168164">5.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397201108">5.1.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397206340">5.1.3. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1397167420">5.2. JSON Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397179660">5.2.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397171236">5.2.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397193204">5.2.3. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1397176380">5.3. XSLT Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397176716">5.3.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397172916">5.3.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397229220">5.3.3. Configuration</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1397075588">6. Testing and Defect Handling</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397073052">6.1. Using wolfilter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397078028">6.1.1. Testing a Filter</a></span></dt><dt><span class="sect2"><a href="#idp1397277004">6.1.2. Testing a Form</a></span></dt><dt><span class="sect2"><a href="#idp1397278348">6.1.3. Testing a Function</a></span></dt></dl></dd></dl></dd><dt><span class="glossary"><a href="#idp1397256820">Glossary</a></span></dt><dt><span class="index"><a href="#idp1397291692">Index</a></span></dt><dt><span class="appendix"><a href="#idp1397296140">A. Language Grammars</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397337788">A.1. Grammars</a></span></dt></dl></dd><dt><span class="appendix"><a href="#gpl">B. 
    <acronym class="acronym">GNU</acronym> General Public License version 3
  </a></span></dt></dl></dd><dt><span class="book"><a href="#book_Client">Wolframe Clients</a></span></dt><dd><dl><dt><span class="chapter"><a href="#idp1397664372">1. Introduction</a></span></dt><dt><span class="chapter"><a href="#idp1397696108">2. Presentation Tier</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397693900">2.1. Wolframe Standard Client (wolfclient)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397694220">2.1.1. Architecture</a></span></dt><dt><span class="sect2"><a href="#idp1397748348">2.1.2. Artifacts</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397749396">UI forms</a></span></dt><dt><span class="sect3"><a href="#idp1397751028">UI form translations</a></span></dt><dt><span class="sect3"><a href="#idp1397754884">Resources</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1397756508">2.1.3. Programming the Interface</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397759292">Mapping XML Data</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1397759612">Starting Position</a></span></dt><dt><span class="sect4"><a href="#idp1397760796">First Example</a></span></dt><dt><span class="sect4"><a href="#idp1397768188">Another Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1397776228">Switching UI forms</a></span></dt><dt><span class="sect3"><a href="#idp1397781140">States and properties of widgets</a></span></dt><dt><span class="sect3"><a href="#idp1397782748">Widget properties as dynamic property values</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1397784116">2.1.4. Eliminating Interface Defects</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397785252">Switch the Developer Mode On</a></span></dt><dt><span class="sect3"><a href="#idp1397788420">Inspect Errors and Warnings and Debug Messages Reported</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="index"><a href="#idp1397815028">Index</a></span></dt></dl></dd></dl></div><div xml:lang="en" class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="book_AppDevelopment"></a>Developing Wolframe Server Applications</h1></div><div><h2 class="subtitle">Wolframe Application Development Manual</h2></div><div><p class="copyright">Copyright © 2010 - 2013 Project Wolframe</p></div><div><div class="legalnotice"><a id="idp1395537276"></a><p><strong>Commercial Usage. </strong>
	    Licensees holding valid Project Wolframe Commercial licenses may
	    use this file in accordance with the Project Wolframe
	    Commercial License Agreement provided with the Software or,
	    alternatively, in accordance with the terms contained
	    in a written agreement between the licensee and Project Wolframe.
	</p><p><strong>GNU General Public License Usage. </strong>
	    Alternatively, you can redistribute this file and/or modify it
	    under the terms of the <acronym class="acronym">GNU</acronym> General Public License as published by
	    the Free Software Foundation, either version 3 of the License, or
	    (at your option) any later version.
	</p><p>
    Wolframe is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    <acronym class="acronym">GNU</acronym> General Public License for more details.
</p><p>
    You should have received a copy of the GNU General Public License
    along with Wolframe.  If not, see
    <a class="ulink" href="http://www.gnu.org/licenses/" target="_top"><em class="citetitle">http://www.gnu.org/licenses/</em></a>
</p><p>
    If you have questions regarding the use of this file, please contact
    Project Wolframe.
</p></div></div><div><p class="pubdate">October 31, 2013
 version 0.0.3
</p></div></div><hr /></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="preface"><a href="#idp1393189348">Foreword</a></span></dt><dt><span class="chapter"><a href="#idp1393804268">1. Introduction</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1393804612">1.1. Introduction to Service Development</a></span></dt><dt><span class="sect1"><a href="#idp1393212364">1.2. Architecture</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1393215244">1.2.1. Presentation tier</a></span></dt><dt><span class="sect2"><a href="#idp1393216588">1.2.2. Logic tier</a></span></dt><dt><span class="sect2"><a href="#idp1393221476">1.2.3. Data tier</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1393170532">2. Command Handler</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1396487940">2.1. The Standard Command Handler</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396488260">2.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1393168668">2.1.2. Example Configuration</a></span></dt><dt><span class="sect2"><a href="#idp1396523956">2.1.3. Example Command Description</a></span></dt><dt><span class="sect2"><a href="#idp1396526476">2.1.4. Command Description Language</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396544932">Overview</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1396568940">3. Functions</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1396613308">3.1. Functions in Transaction Definition Language (TDL)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396613684">3.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396649100">3.1.2. Examples</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396649420">First Example</a></span></dt><dt><span class="sect3"><a href="#idp1396651380">Preprocessing Input</a></span></dt><dt><span class="sect3"><a href="#idp1396653004">Using Variables</a></span></dt><dt><span class="sect3"><a href="#idp1396654684">Subroutines</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1396656292">3.1.3. Language Description</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396657060">Subroutines</a></span></dt><dt><span class="sect3"><a href="#idp1396659180">Transaction Function Declarations</a></span></dt><dt><span class="sect3"><a href="#idp1396666036">Main Processing Instructions</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396671948">Main Processing Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396673660">Preprocessing Instructions</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396677276">Preprocessing Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396678948">Selector Path</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396683988">Path Expression Examples</a></span></dt><dt><span class="sect4"><a href="#idp1396689268">Path Usage Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396690932">Referencing Database Results</a></span></dt><dt><span class="sect3"><a href="#idp1396696260">Naming Database Results</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396697684">Named Result Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396699236">Referencing Subroutine Parameters</a></span></dt><dt><span class="sect3"><a href="#idp1396701396">Constraints on database results</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396704684">Example with Result Constraints</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396706380">Rewriting Error Messages for the Client</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396708124">Database Error HINT Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396710700">Substructures in the Result</a></span></dt><dt><span class="sect3"><a href="#idp1396713316">Explicit Definition of Elements in the Result</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#idp1396760404">3.2. Functions in .NET</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396760724">3.2.1. Introduction</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396752700">3.3. Functions in Python</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396753044">3.3.1. Introduction</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396760172">3.4. Functions in Lua</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396759028">3.4.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396812700">3.4.2. Declaring Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396814988">3.4.3. Wolframe Provider Library</a></span></dt><dt><span class="sect2"><a href="#idp1396819060">3.4.4. Wolframe Global Objects</a></span></dt><dt><span class="sect2"><a href="#idp1396822100">3.4.5. Using Forms</a></span></dt><dt><span class="sect2"><a href="#idp1396829220">3.4.6. Form Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396834220">3.4.7. List of <span class="application">Lua</span> Objects</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396896364">3.5. DDL Data Types</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396896708">3.5.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396885620">3.5.2. Example</a></span></dt><dt><span class="sect2"><a href="#idp1396929708">3.5.3. Language Description</a></span></dt><dt><span class="sect2"><a href="#idp1396932324">3.5.4. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396893860">3.6. Functions in C++</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396894204">3.6.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396895892">3.6.2. Declaring Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396890572">3.6.3. Input/Output Data Structures</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1397053844">4. Forms</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397100548">4.1. Form Data Definition Languages</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397100868">4.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397091228">4.1.2. Forms in Simpleform DDL</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1397124932">5. Filters</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397167828">5.1. XML Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397168164">5.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397201108">5.1.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397206340">5.1.3. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1397167420">5.2. JSON Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397179660">5.2.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397171236">5.2.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397193204">5.2.3. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1397176380">5.3. XSLT Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397176716">5.3.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397172916">5.3.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397229220">5.3.3. Configuration</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp1397075588">6. Testing and Defect Handling</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397073052">6.1. Using wolfilter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397078028">6.1.1. Testing a Filter</a></span></dt><dt><span class="sect2"><a href="#idp1397277004">6.1.2. Testing a Form</a></span></dt><dt><span class="sect2"><a href="#idp1397278348">6.1.3. Testing a Function</a></span></dt></dl></dd></dl></dd><dt><span class="glossary"><a href="#idp1397256820">Glossary</a></span></dt><dt><span class="index"><a href="#idp1397291692">Index</a></span></dt><dt><span class="appendix"><a href="#idp1397296140">A. Language Grammars</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397337788">A.1. Grammars</a></span></dt></dl></dd><dt><span class="appendix"><a href="#gpl">B. 
    <acronym class="acronym">GNU</acronym> General Public License version 3
  </a></span></dt></dl></div><div class="list-of-figures"><p><strong>List of Figures</strong></p><dl><dt>1.1. <a href="#idp1393802220">Overview</a></dt><dt>1.2. <a href="#idp1393213220">Overview</a></dt></dl></div><div class="list-of-tables"><p><strong>List of Tables</strong></p><dl><dt>2.1. <a href="#idp1396546764">Options</a></dt><dt>3.1. <a href="#idp1396835116">Data forms declared by DDL</a></dt><dt>3.2. <a href="#idp1396844052">Data forms returned by functions</a></dt><dt>3.3. <a href="#idp1396849804">Global Transaction Context</a></dt><dt>3.4. <a href="#idp1396853428">Logger functions</a></dt><dt>3.5. <a href="#idp1396857204">Global functions</a></dt><dt>4.1. <a href="#idp1397137252">element attributes in simpleform</a></dt></dl></div><div class="preface"><div class="titlepage"><div><div><h1 class="title"><a id="idp1393189348"></a>Foreword</h1></div></div></div><p>The <span class="application">Wolframe</span> project was started in 2010.
	The goal was to create a platform for fully customizable
	business applications that can be hosted in modern system environments.
	</p><p>
	This manual introduces the architecture of <span class="application">Wolframe</span> and explains
	how to build client/server applications with it. After reading this
	you should be able to create an application on your own.
	</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp1393804268"></a>Chapter 1. Introduction</h1></div><div><h1 class="title"><a id="idp1393804268"></a>Chapter 1. Introduction</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="sect1"><a href="#idp1393804612">1.1. Introduction to Service Development</a></span></dt><dt><span class="sect1"><a href="#idp1393212364">1.2. Architecture</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1393215244">1.2.1. Presentation tier</a></span></dt><dt><span class="sect2"><a href="#idp1393216588">1.2.2. Logic tier</a></span></dt><dt><span class="sect2"><a href="#idp1393221476">1.2.3. Data tier</a></span></dt></dl></dd></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1393804612"></a>1.1. Introduction to Service Development</h2></div></div></div><p><span class="application">Wolframe</span> application server requests consist of a named command and a structured
		content (document) as argument.</p><p>In this chapter we describe how <span class="application">Wolframe</span> application server requests are
		processed. You will understand the involved bricks of software and how they are configured to build
		the backend of your <span class="application">Wolframe</span> application.
		</p><p>The following illustration shows the processing of one client request to the server.
			A call of the <span class="application">Wolframe</span> logic tier gets to a command handler
			that calls functions given by the provider to perform the transaction
			requested.
		</p><div class="figure"><a id="idp1393802220"></a><p class="title"><strong>Figure 1.1. Overview</strong></p><div class="figure-contents"><div class="mediaobject"><object type="image/svg+xml" data="images/LogicTier.svg" width="1620"></object><div class="caption"><p></p></div></div></div></div><br class="figure-break" /><p>
			We will describe now the <span class="application">Wolframe</span> standard command handler and how it is configured.
			Then we will show how to write programs that declare the functions executing the requests 
			and how you link them to your application.
		</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1393212364"></a>1.2. Architecture</h2></div></div></div><p><span class="application">Wolframe</span> is a 3-tier application server.
		</p><div class="figure"><a id="idp1393213220"></a><p class="title"><strong>Figure 1.2. Overview</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td><object type="image/svg+xml" data="images/3-tier.svg" height="360"></object></td></tr></table><div class="caption"><p></p></div></div></div></div><br class="figure-break" /><p></p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1393215244"></a>1.2.1. Presentation tier</h3></div></div></div><p>The presentation tier of <span class="application">Wolframe</span> is implemented as a thin client.
			It maps the presentation of the application from the request answers it gets from the server.
			Also the data describing this mapping is loaded from the server when connecting to it.
			So the whole application is driven by the server.
			Special use cases are designers of user interfaces that upload the presentation data for other users
			to the server.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1393216588"></a>1.2.2. Logic tier</h3></div></div></div><p>The logic tier of <span class="application">Wolframe</span> describes the transformation of input of the presentation tier to a set of instructions
			for the data tier. The input to the logic tier  consists of a command name plus a
			structured content also referred to as document. The
			logic tier returns a single document to the presentation tier.
			The logic tier supports scripting languages to define the input/output mapping between the
			layers. 
			<span class="application">Wolframe</span> introduces three concepts as building blocks of the logic tier:
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><em class="glossterm">Filters</em>: Filters are transforming serialized input data (XML,JSON,CSV,etc.) to a unified serialization of hierarchically structured data and to serialize any form of processed data for output. Filters are implemented as loadable modules (e.g. XML filter based on libxml2, JSON filter based on cJSON) or as scripts based on a filter module (XSLT filter script for rewriting input or output)</p></li><li class="listitem"><p><em class="glossterm">Forms</em>: Forms are data structures defined in a data definition language (DDL). Forms are used to validate and normalize input (XML validation, token normalization, structure definition). The recommended definition of a command in the logic tier has a form to validate its input and a form to validate its output before returning it to the caller.</p></li><li class="listitem"><p><em class="glossterm">Functions</em>: Functions delegate processing to the data tier (transactions) or they are simple data transformations or they serve as interface to integrate with other environments (e.g. <span class="application">.NET</span>). Functions have a unique name and are called with a structure as argument and a structure as result. Functions can call other functions for delegation, e.g. a transaction definition can call a .NET function for preprocessing its input or a .NET function can call a Python function to do parts of the processing.</p></li></ul></div><p>
			You find a detailed description of the Logic tier and how to use it in the SDK manual.
			</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1393221476"></a>1.2.3. Data tier</h3></div></div></div><p>The data tier of <span class="application">Wolframe</span> defines the functions for calling a transaction.
			The main transaction function gets a complete description of the transaction to execute as input and returns
			all results of the transaction as output. The logic tier builds the result data structure out of this result.
			The main transaction function is stateless and an abstraction of the transactional context. (The transaction
			context does not exist outside this function. Explained differently: Two functions do not refer to the same
			transaction).</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp1393170532"></a>Chapter 2. Command Handler</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="sect1"><a href="#idp1396487940">2.1. The Standard Command Handler</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396488260">2.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1393168668">2.1.2. Example Configuration</a></span></dt><dt><span class="sect2"><a href="#idp1396523956">2.1.3. Example Command Description</a></span></dt><dt><span class="sect2"><a href="#idp1396526476">2.1.4. Command Description Language</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396544932">Overview</a></span></dt></dl></dd></dl></dd></dl></div><p>This chapter introduces the standard command handler of the logic tier.
</p><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1396487940"></a>2.1. The Standard Command Handler</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396488260"></a>2.1.1. Introduction</h3></div></div></div><p>
		The <span class="application">Wolframe</span> standard command handler is called <em class="glossterm">directmap</em> and named so
		in the configuration because it only declares a redirection of the commands to functions based on 
		the document type and the command identifier specified by the client in the request.
	</p><p>
		The declarations of the <span class="application">Wolframe</span> Standard Command Handler (<em class="glossterm">directmap</em>)
		are specified in a program source file with the extension '.dmap' that is declared in the configuration.
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1393168668"></a>2.1.2. Example Configuration</h3></div></div></div><p>The following configuration declares a program <code class="code">example.tdl</code> written in the 
		transaction definition language (<acronym class="acronym">TDL</acronym>) to contain the function
		declarations for the provider that can be called by the command handler. It declares the database with
		name <span class="application">pgdb</span> to be used as the database for transactions. It loads a description 
		<code class="code">example.dmap</code> that will declare the mappings of commands to the filters used and functions 
		called. It specifies the filter with name <span class="application">libxml2</span> to be used for documents of format XML and
		the filter with name <span class="application">cjson</span> to be used for documents of format JSON, if
		not specified else in <code class="code">example.dmap</code>.

		</p><pre class="programlisting">
		; Simple Data Processing Configuration Example
Processor
{
     ; Programs to load:
     program example.tdl              ; a program with functions (in TDL)
     database pgdb                    ; references transaction database

     ; Command handlers to load:
     cmdhandler
     {
          directmap                   ; the standard command handler
          {
               program example.dmap   ; description of command mappings

               filter XML=libxml2     ; std filter for XML document format
               filter JSON=cjson      ; std filter for JSON document format
          }
     }
}


		</pre><p>
		</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396523956"></a>2.1.3. Example Command Description</h3></div></div></div><p>The following source example could be one of the <code class="code">example.dmap</code> in the configuration example 
		introduced above. It defines two commands. The first one links a command "insert" with document type
		"Customer" as content to a transaction function "doInsertCustomer". The content is validated 
		automatically against a form named "Customer" if not explicitly defined else. 
		The command has no result except that it succeeds or fails. The second example command links a 
		command "get" with a document type "Employee" to a function "doSelectEmployee". 
		The input is not validated and the transaction output is validated and mapped through the 
		form "Employee".
	</p><p>
		</p><pre class="programlisting">
		
COMMAND insert Customer CALL doInsertCustomer;
COMMAND get Employee PASS CALL doSelectEmployee( xml ) RETURN Employee;


		</pre><p>
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396526476"></a>2.1.4. Command Description Language</h3></div></div></div><p>
		A command map description file like our example shown consists of instructions started with 
		<code class="code">COMMAND</code> and terminated by semicolon ';'. The first argument after <code class="code">COMMAND</code> is the name of the
		command followed by the name of the document type of the input document. The name of the command
		is optional. If not specified the first argument after <code class="code">COMMAND</code> names the input document type.

		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396527932"></a>Simple Document Map</h5></div></div></div><p>
				The following example shows the simplest possible declaration. It states that documents with the
				document type "Document" are forwarded to a function with the same name "Document".
				</p><pre class="programlisting">
				
COMMAND Document;

				</pre><p>
			</p></div><p>
		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396529596"></a>Command with Action Prefix</h5></div></div></div><p>
				The next example adds a action name to the declaration. The implicit name of the function called is
				insertDocument:
				</p><pre class="programlisting">
				
COMMAND insert Document;

				</pre><p>
			</p></div><p>
		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396531196"></a>Explicit Function Name Declaration</h5></div></div></div><p>
				For declaring the function called explicitly like for example a function <code class="code">doInsertDocument</code> we need to declare it with <code class="code">CALL &lt;functionname&gt;</code>:
				</p><pre class="programlisting">
				
COMMAND insert Document CALL doInsertDocument;

				</pre><p>
			</p></div><p>
		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396533268"></a>Returned Document Declaration</h5></div></div></div><p>
				The document type returned is specified with <code class="code">RETURN &lt;doctype&gt;</code>:
				</p><pre class="programlisting">
				
COMMAND process Document RETURN Document;

				</pre><p>
				or with explicit naming of a function called
				</p><pre class="programlisting">
				
COMMAND process Document CALL doProcessDocument RETURN Document;

				</pre><p>
			</p></div><p>
		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396536036"></a>Skipping Document Validation</h5></div></div></div><p>
				If you want to skip the input document validation, either because you are dealing
				with legacy software where a strict definition of a schema is not possible or
				because the function called has strict typing and validates the input on its own (.NET,C++),
				then you can add a declaration <code class="code">SKIP</code>:
				</p><pre class="programlisting">
				
COMMAND process Document SKIP CALL doProcessDocument RETURN Document;

				</pre><p>
				The same you can specify for the output in the <code class="code">RETURN</code> declaration:
				</p><pre class="programlisting">
				
COMMAND process Document CALL doProcessDocument RETURN SKIP Document;

				</pre><p>
			</p></div><p>
		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396539220"></a>Explicit Filter Definitions for a Command</h5></div></div></div><p>
				For most processing it's enough to declare the standard filters in the configuration of the command handler.
				But in certain cases you want to explicitly declare a filter for a command, for
				example to preprocess a certain document type with an XSLT filter. Explicitly declared
				filters always refer to a document format and documents of other formats have to be converted
				first or they cannot be preprocessed. The conversions mechanisms we will explain in detail
				later. Explicit filter declarations are done with
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="code">FILTER &lt;name&gt;</code> or</p></li><li class="listitem"><p><code class="code">FILTER INPUT &lt;inputfiltername&gt;</code> or</p></li><li class="listitem"><p><code class="code">FILTER OUTPUT &lt;outputfiltername&gt;</code> or</p></li><li class="listitem"><p><code class="code">FILTER INPUT &lt;inputfiltername&gt; OUTPUT &lt;outputfiltername&gt;</code></p></li></ul></div><p>
				Here is an example:
				</p><pre class="programlisting">
				
COMMAND process Document FILTER INPUT myXsltInputFilter
    CALL doProcessDocument RETURN Document;

				</pre><p>
			</p></div><p>
		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396543220"></a>Using Brackets</h5></div></div></div><p>
				For better readability you can use optional '(' ')' brackets on the arguments. This way you can distinguish
				better between keywords and arguments:
				</p><pre class="programlisting">
				
COMMAND ( process Document )
    FILTER INPUT ( myXsltInputFilter ) CALL ( doProcessDocument )
    RETURN ( Document );

				</pre><p>
			</p></div><p>
	</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396544932"></a>Overview</h4></div></div></div><p>Each command declaration has as already explained the form
		</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="code">COMMAND &lt;doctype&gt; [OPTIONS] ;</code> or</p></li><li class="listitem"><p><code class="code">COMMAND &lt;action&gt; &lt;doctype&gt; [OPTIONS] ;</code></p></li></ul></div><p>
		The following table shows an overview of the elements that can be used in the <code class="code">[OPTIONS]</code> part of the command:

		</p><div class="table"><a id="idp1396546764"></a><p class="title"><strong>Table 2.1. Options</strong></p><div class="table-contents"><table summary="Options" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Keywords</th><th>Arguments</th><th>Description</th></tr></thead><tbody><tr><td>CALL</td><td>Function Name</td><td>Names the function to be called for processing the request</td></tr><tr><td>RETURN</td><td>Document Type</td><td>Specifies the type of the document returned and forces validation of the output</td></tr><tr><td>RETURN SKIP</td><td>Document Type</td><td>Specifies the type of the document returned but skips validation of the output</td></tr><tr><td>SKIP</td><td>(no arguments)</td><td>Specifies the input document validation to be skipped</td></tr><tr><td>FILTER INPUT</td><td>Filter Name</td><td>Specifies that the filter &lt;Name&gt; should be used as input filter</td></tr><tr><td>FILTER OUTPUT</td><td>Filter Name</td><td>Specifies that the filter &lt;Name&gt; should be used as output filter</td></tr><tr><td>FILTER</td><td>Filter Name</td><td>Specifies that the filter &lt;Name&gt; should be used both as input and output filter</td></tr></tbody></table></div></div><p><br class="table-break" />

		</p></div></div><p></p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp1396568940"></a>Chapter 3. Functions</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="sect1"><a href="#idp1396613308">3.1. Functions in Transaction Definition Language (TDL)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396613684">3.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396649100">3.1.2. Examples</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396649420">First Example</a></span></dt><dt><span class="sect3"><a href="#idp1396651380">Preprocessing Input</a></span></dt><dt><span class="sect3"><a href="#idp1396653004">Using Variables</a></span></dt><dt><span class="sect3"><a href="#idp1396654684">Subroutines</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1396656292">3.1.3. Language Description</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1396657060">Subroutines</a></span></dt><dt><span class="sect3"><a href="#idp1396659180">Transaction Function Declarations</a></span></dt><dt><span class="sect3"><a href="#idp1396666036">Main Processing Instructions</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396671948">Main Processing Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396673660">Preprocessing Instructions</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396677276">Preprocessing Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396678948">Selector Path</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396683988">Path Expression Examples</a></span></dt><dt><span class="sect4"><a href="#idp1396689268">Path Usage Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396690932">Referencing Database Results</a></span></dt><dt><span class="sect3"><a href="#idp1396696260">Naming Database Results</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396697684">Named Result Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396699236">Referencing Subroutine Parameters</a></span></dt><dt><span class="sect3"><a href="#idp1396701396">Constraints on database results</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396704684">Example with Result Constraints</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396706380">Rewriting Error Messages for the Client</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1396708124">Database Error HINT Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1396710700">Substructures in the Result</a></span></dt><dt><span class="sect3"><a href="#idp1396713316">Explicit Definition of Elements in the Result</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#idp1396760404">3.2. Functions in .NET</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396760724">3.2.1. Introduction</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396752700">3.3. Functions in Python</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396753044">3.3.1. Introduction</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396760172">3.4. Functions in Lua</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396759028">3.4.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396812700">3.4.2. Declaring Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396814988">3.4.3. Wolframe Provider Library</a></span></dt><dt><span class="sect2"><a href="#idp1396819060">3.4.4. Wolframe Global Objects</a></span></dt><dt><span class="sect2"><a href="#idp1396822100">3.4.5. Using Forms</a></span></dt><dt><span class="sect2"><a href="#idp1396829220">3.4.6. Form Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396834220">3.4.7. List of <span class="application">Lua</span> Objects</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396896364">3.5. DDL Data Types</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396896708">3.5.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396885620">3.5.2. Example</a></span></dt><dt><span class="sect2"><a href="#idp1396929708">3.5.3. Language Description</a></span></dt><dt><span class="sect2"><a href="#idp1396932324">3.5.4. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1396893860">3.6. Functions in C++</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1396894204">3.6.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1396895892">3.6.2. Declaring Functions</a></span></dt><dt><span class="sect2"><a href="#idp1396890572">3.6.3. Input/Output Data Structures</a></span></dt></dl></dd></dl></div><p>This chapter describes how functions are linked to the logic tier. It introduces a language to write
database transaction functions and a language to describe atomic data type normalizations and gives an overview
on the language bindings available for Wolframe.
</p><p>
After reading this chapter you should be able to write functions of the <span class="application">Wolframe</span> logic tier on your own.
</p><p>
Be aware that you have to configure a programming language of the logic tier in <span class="application">Wolframe</span>
before using it. Each chapter introducing a programming language will have a section that describes how the server
configuration of <span class="application">Wolframe</span> has to be extended for its availability.
</p><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1396613308"></a>3.1. Functions in Transaction Definition Language (TDL)</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396613684"></a>3.1.1. Introduction</h3></div></div></div><p>
			For the description of transactions <span class="application">Wolframe</span> provides the
			transaction definition language (<acronym class="acronym">TDL</acronym>) introduced here.
			<span class="application">Wolframe</span> transactions in <acronym class="acronym">TDL</acronym> are defined as functions in a
			transactional context. This means that whatever is executed in a transaction function
			belongs by default to a database transaction with an automatic commit on function completion
			if not explicitly defined otherwise by the caller. Errors lead to an automatic abort
			of the database transaction.
		</p><p>
			A <acronym class="acronym">TDL</acronym> transaction function takes a structure as input
			and returns a structure as output.
			The <span class="application">Wolframe</span> database interface defines 
			a transaction as context where the input is passed as a structure 
			and the output is fetched from it as a structure.
		</p><p>
			TDL is a language to describe the building of transaction 
			input and the building of the result structure from the database output.
			It defines a transaction as a sequence of instructions on multiple data.
			An instruction is either described as a single embedded database command
			in the language of the underlying database, a name of a function declared
			in the database (e.g. a PLSQL function) or a TDL subroutine call
			working on multiple data.
		</p><p>
			Working on multiple data means that the instruction is executed
			for every item of an input set. This set can consist of the set of
			results of a previous instruction or a selection of the
			input of the transaction function. A "for each" selector
			defines the input set as part of the instruction.
		</p><p>
			Each instruction result can be declared as being part of the transaction
			result structure. The language has no control structures and is 
			therefore not a general purpose programming language.
			It just offers some mapping of the input to commands and from the command 
			results back to the output.
		</p><p>
			To convert input data the transaction definition language 
			defines a preprocessing section where globally defined Wolframe
			functions can be called for the selected input. To build an output 
			structure that cannot be modeled with a language without control
			structures and recursion, TDL provides the possibility to call a
			globally defined function as filter for postprocessing of the
			result of the transaction function.
		</p><p>
			The TDL is case insensitive. For clearness and better readability
			TDL keywords are written in uppercase here.
		</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396649100"></a>3.1.2. Examples</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396649420"></a>First Example</h4></div></div></div><p>Our first example selects a key from a table and inserts it into a list. The substitute "$1" refers to the first column of the query result "SELECT id FROM UserTable ..". The substitute "$(name)" in the first statement refers to the toplevel element 'name' of the input. In the second statement it refers to the "name" element of the "item" selection in the query, e.g. for each element with the path "/item/name" (name being unique per item and item describing a set of items).
		</p><pre class="programlisting">
		
TRANSACTION insertItem
BEGIN
    INTO user
        DO UNIQUE NONEMPTY SELECT id FROM UserTable
            WHERE name = $(name);
    FOREACH item
        DO INSERT INTO ItemTable (ownerid,name)
            VALUES ($RESULT.id,$(name));
END

		</pre><p>
		</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396651380"></a>Preprocessing Input</h4></div></div></div><p>This example selects identifiers 'id' of all users matched by their normalized name. The normalization of the name is done in a preprocessing step.
		</p><pre class="programlisting">
		
TRANSACTION selectPersonId
PREPROCESS BEGIN
    FOREACH person INTO normalizedName
        DO normalize_diachars( name );
END
BEGIN
    FOREACH person INTO user
        DO UNIQUE NONEMPTY
            SELECT id FROM UserTable
                WHERE name = $(normalizedName);
END


		</pre><p>
		</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396653004"></a>Using Variables</h4></div></div></div><p>This example returns the 'id' of a country matched by their normalized name.
		The normalization of country names is done in a preprocessing step. 
		The result is printed into a structure 'country/code'.
		</p><pre class="programlisting">
		
TRANSACTION selectCountry
PREPROCESS BEGIN
    INTO country/normalizedName DO normalize_diachars( country/name );
END
BEGIN
    DO UNIQUE NONEMPTY SELECT id FROM CountryTable
        WHERE name = $(country/normalizedName);
    KEEP AS COUNTRY;
        -- assigning the result with column name
        --   'id' to the variable 'countrycode'
    RESULT INTO country
        -- building a result block with name 'country'
    BEGIN
        INTO code PRINT $COUNTRY.id;
        -- printing the variable 'countrycode' with tag 'code'
        --   into the 'country' result block
    END
END


		</pre><p>
		</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396654684"></a>Subroutines</h4></div></div></div><p>This example calls a subroutine with one argument to map the output.
		</p><pre class="programlisting">
		
SUBROUTINE selectFamilyMembers( id)
BEGIN
    INTO member
        DO SELECT surname,prename FROM PersonTable
            WHERE id = $PARAM.id;
END

TRANSACTION getFamilyMembers
BEGIN
    FOREACH person INTO . DO selectFamilyMembers( id);
END


		</pre><p>
		</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396656292"></a>3.1.3. Language Description</h3></div></div></div><p>
		A TDL program consists of subroutine declarations and exported
		transaction function declarations. Subroutines have the same
		structure as transaction function blocks but without pre- and postprocessing
		and authorization method declarations.
		</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396657060"></a>Subroutines</h4></div></div></div><p>A subroutine declaration starts with the Keyword <code class="code">SUBROUTINE</code>
			followed by the subroutine name. After this header and an optional 
			result substructure name declaration, the code definition block
			follows starting with <code class="code">BEGIN</code>, ending with <code class="code">END</code>.
			</p><pre class="programlisting">
			SUBROUTINE &lt;name&gt;
			RESULT INTO &lt;result-block-name&gt;
			BEGIN
				...&lt;instructions&gt;...
			END
			</pre><p>
			The line with the RESULT INTO declaration is optional.
			</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396659180"></a>Transaction Function Declarations</h4></div></div></div><p>A transaction function declaration starts with the Keyword <code class="code">TRANSACTION</code>
			followed by the name of the transaction function. This name identifies the
			function globally. The body of the function contains the following parts:
			</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="code">AUTHORIZE ( &lt;auth-function&gt;, &lt;auth-resource&gt; )</code><p>
						This optional definition is dealing with 
						authorization and access rights.
					</p></li><li class="listitem"><code class="code">RESULT INTO &lt;result-block-name&gt; FILTER &lt;post-filter-name&gt;</code><p>
						This optional declaration defines a top level tag for the 
						result structure and optionally a postprocessing step as
						filter referenced by name.
						It is similar as the construct in the subroutine description
						except that one cannot specify a postprocessing filter
						in a subroutine.
					</p></li><li class="listitem"><code class="code">PREPROCESS BEGIN &lt;...preprocessing instructions...&gt; END</code><p>
						This optional block contains instructions on the transaction
						function input. The result of these preprocessing instructions are
						put into the input structure, so that they can be referred to in the main
						code definition block of the transaction.
						We can call any global normalization or form function in the 
						preprocessing block to enrich or transform the input to process.
					</p></li><li class="listitem"><code class="code">BEGIN &lt;...instructions...&gt; END</code><p>
					The main processing block starts with <code class="code">BEGIN</code> and
					ends with <code class="code">END</code>. It contains all the database instructions
					needed for completing this transaction.
					</p></li></ul></div><p>
			The following pseudo code snippet shows the explained building
			blocks together:
			</p><pre class="programlisting">
	
			TRANSACTION &lt;name&gt;
			AUTHORIZE ( &lt;auth-function&gt;, &lt;auth-resource&gt; )
			RESULT INTO &lt;result-block-name&gt; FILTER &lt;post-filter-name&gt;
			PREPROCESS BEGIN
				...&lt;preprocessing instructions&gt;...
			END
			BEGIN
				...&lt;instructions&gt;...
			END
			</pre><p>
			The lines with AUTHORIZE and RESULT INTO and FILTER declarations are optional.
			So is the preprocessing block PREPROCESS..BEGIN..END. A simpler transaction
			function looks like the following:
			</p><pre class="programlisting">
	
			TRANSACTION &lt;name&gt;
			BEGIN
				...&lt;instructions&gt;...
			END
			</pre><p>
			</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396666036"></a>Main Processing Instructions</h4></div></div></div><p>Main processing instructions defined in the main execution block 
			of a subroutine or transaction function consist of three parts in the
			following order terminated by a semicolon ';' (the order of the 
			INTO and FOREACH expression can be switched):
			</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="code">INTO &lt;result substructure name&gt;</code><p>
						This optional directive specifies if and where the results
						of the database commands should be put into as part of the
						function output. In subroutines this substructure is
						relative to the current substructure addressed in the
						callers context.
						For example a subroutine with an "INTO myres"
						directive called by a subroutine with an "INTO output"
						directive will write its result into a substructure with path
						"output/myres".
					</p></li><li class="listitem"><code class="code">FOREACH &lt;selector&gt;</code><p>
						This optional directive defines the set of 
						elements on which the instruction is executed one by one.
						Specifying a set of two elements will cause the function to
						be called twice. An empty set as selection will
						cause the instruction to be ignored. Without
						quantifier the database command or subroutine call
						of the instruction will be always be executed once.
					</p><p>
						The argument of the FOREACH expression is either
						a reference to the result of a previous 
						instruction or a path selecting a set of input
						elements.
					</p><p>
						Results of previous instructions are referenced either with
						the keyword RESULT referring to the result set
						of the previous command or with a variable
						naming a result set declared with this name before.
						
					</p>
						Input elements are selected by path relative
						to the path currently selected, starting from
						the input root element when entering a transaction
						function. The current path selected and the base
						element of any relative path calculated in this scope
						changes when a subroutine is called in a FOREACH selection
						context. For example calling a subroutine in a
						'FOREACH person' context will cause
						relative paths in this subroutine to be sub elements
						of 'person'.
					<p>
					</p></li><li class="listitem"><code class="code">DO &lt;command&gt;</code><p>
						Commands in an instruction are either embedded
						database commands, named database functions (e.g. PLSQL functions)
						or subroutine calls. Command arguments
						are either constants or relative paths 
						from the selector path in the FOREACH selection
						or referring to elements in the result of 
						a previous command.
						If an argument is a relative path from the 
						selector context, its reference
						has to be unique in the context of the 
						element selected by the selector.
						If an argument references a previous command
						result it must either be unique or dependent
						an the FOREACH argument. 
						Results that are sets with more than one element
						can only be referenced if they are bound to 
						the FOREACH quantifier.
					</p></li></ul></div><p>
			</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396671948"></a>Main Processing Example</h5></div></div></div><p>The following example illustrate how the FOREACH,INTO,DO
				expressions in the main processing block work together:
				</p><pre class="programlisting">
				
TRANSACTION insertCustomerAddresses
BEGIN
    DO SELECT id FROM Customer
        WHERE name = $(customer/name);
    FOREACH /customer/address
        DO INSERT INTO Address (id,address)
        VALUES ($RESULT.id, $(address));
END

				</pre><p>
				</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396673660"></a>Preprocessing Instructions</h4></div></div></div><p>Preprocessing instructions defined in the PREPROCESS execution block 
			of a transaction function consist similar to the instructions
			in the main execution block of three parts in the
			following order terminated by a semicolon ';' (the order of the INTO and FOREACH expression can be
			switched):
		</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="code">INTO &lt;result substructure name&gt;</code><p>
					This optional directive specifies if and where the results
					of the preprocessing commands should be put into as part
					of the input to be processed by the main processing
					instructions. The relative paths of the destination structure
					are calculated relative to a FOREACH selection element.
				</p></li><li class="listitem"><code class="code">FOREACH &lt;selector&gt;</code><p>
					This optional directive defines the set of 
					elements on which the instruction is executed one by one.
					The preprocessing command is executed once for each 
					element in the selected set and it will not be executed 
					at all if the selected set is empty.
				</p></li><li class="listitem"><code class="code">DO &lt;command&gt;</code><p>
					Commands in an instruction are function calls to
					globally defined form functions or normalization
					functions. Command arguments
					are constants or relative paths from the selector
					path in the FOREACH selection. They are uniquely
					referencing elements in the context of a selected element.
				</p></li></ul></div><p>
		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396677276"></a>Preprocessing Example</h5></div></div></div><p>The following example illustrate how the "FOREACH, INTO, DO"
				expressions in the main processing block work together:
				</p><pre class="programlisting">
				
TRANSACTION insertPersonTerms
PREPROCESS BEGIN
    FOREACH //address/* INTO normalized
        DO normalizeStructureElements(.);
    FOREACH //id INTO normalized
        DO normalizeNumber(.);
END
BEGIN
    DO UNIQUE SELECT id FROM Person
        WHERE name = $(person/name);
    FOREACH //normalized DO
        INSERT INTO SearchTerm (id, value)
        VALUES ($RESULT.id, $(.));
END

				</pre><p>
				</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396678948"></a>Selector Path</h4></div></div></div><p>An element of the input or a set of input elements can be selected by a path.
			A path is a sequence of one of the following elements separated by slashes:
			</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Identifier
				<p>
				An identifier uniquely selects a sub element of the current position in the tree.
				</p></li><li class="listitem"><code class="code">*</code><p>
				An asterisk selects any sub element of the current position in the tree.
				</p></li><li class="listitem"><code class="code">..</code><p>
				Two dots in a row select the parent element of the current position in the tree.
				</p></li><li class="listitem"><code class="code">.</code><p>
				One dots selects the current element in the tree.
				This operator can also be useful as part of a path
				to force the expression to be interpreted
				as path if it could also be interpreted as a keyword of the 
				TDL language (for example <code class="code">./RESULT</code>).
				</p></li></ul></div><p>
			A slash at the beginning of a path selects the root element of the transaction function input tree.
			Two subsequent slashes express that the following node is (transitively) any descendant of the
			current node in the tree.
		</p><p>
			Paths can appear as argument of a FOREACH selector where they specify
			the set of elements on which the attached command is executed on.
			Or they can appear as reference to an argument in a command expression
			where they specify uniquely one element that is passed as argument 
			to the command when it is executed.
		</p><p>
			When used in embedded database statements, selector paths are referenced
			with <code class="code">$(&lt;path expression&gt;)</code>. When used as database
			function or subroutine call arguments path expressions can be used in
			plain without '$' and '(' ')' markers. These markers are just used to 
			identify substitution entities.
		</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396683988"></a>Path Expression Examples</h5></div></div></div><p>The following list shows different ways of addressing an element by path:
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="code">/</code><p>Root element</p></li><li class="listitem"><code class="code">/organization</code><p>Root element with name "organization"</p></li><li class="listitem"><code class="code">/organization/address/city</code><p>Element "city" of root "organization" descendant "address"</p></li><li class="listitem"><code class="code">.//id</code><p>Any descendant element with name "id" of the current element</p></li><li class="listitem"><code class="code">//person/id</code><p>Child with name "id" of any descendant "person" of the root element</p></li><li class="listitem"><code class="code">//id</code><p>Any descendant element with name "id" of the root element</p></li><li class="listitem"><code class="code">/address/*</code><p>Any direct descendant of the root element "address"</p></li><li class="listitem"><code class="code">.</code><p>Currently selected element</p></li></ul></div><p>
				</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396689268"></a>Path Usage Example</h5></div></div></div><p>This example shows the usage of path expression in the
			preprocessing and the main processing part of a transaction function:
			</p><pre class="programlisting">
			
TRANSACTION selectPerson
PREPROCESS BEGIN
    FOREACH /person/name INTO normalized DO normalizeName( . );
    FOREACH /person INTO citycode DO getCityCode( city );
END
BEGIN
    FOREACH person
        DO INSERT INTO Person (Name,NormalizedName,CityCode)
            VALUES ($(name),$(name/normalized),$(citycode));
END


			</pre><p>
			</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396690932"></a>Referencing Database Results</h4></div></div></div><p>Database results of the previous instruction are referenced 
			with a '$RESULT.' followed by the column identifier or column number.
			Column numbers start always from 1, independent from the database!
			So be aware that even if the database counts column from 0 you have
			to use 1 for the first column. 
			</p><p>
			As already explained before, database result sets of cardinality 
			bigger than one cannot be addressed if not bound to a FOREACH
			selection. In statements potentially addressing more than one 
			result element you have to add a <code class="code">FOREACH RESULT</code> quantifier.
			</p><p>
			For addressing results of instructions preceding the previous instruction,
			you have to name them (see next section). The name of the result can then
			be used as FOREACH argument to select the elements of a set to be
			used as base for the command arguments of the instruction. Without
			binding instruction commands with a FOREACH quantifier the named 
			results of an instruction can be referenced as
			<code class="code">$&lt;name&gt;.&lt;columnref&gt;</code>,
			for example as <code class="code">$person.id</code> for the column with name 'id' of the
			result named as 'person'.
			</p><p>
			The 'RESULT.' prefix in references to the previous instruction result
			is a default and can be omitted in instructions that are not 
			explicitly bound to any other result than the last one. So the following
			two instructions are equivalent:
			</p><pre class="programlisting">
				DO SELECT name FROM Company WHERE id = $RESULT.id
				DO SELECT name FROM Company WHERE id = $id
			</pre><p>
			and so are the following two instructions:
			</p><pre class="programlisting">
				FOREACH RESULT DO SELECT name FROM Company WHERE id = $RESULT.id
				FOREACH RESULT DO SELECT name FROM Company WHERE id = $id
			</pre><p>
			</p><p>
			The result name prefix of any named result can also be omitted if the
			instruction is bound to a FOREACH selector naming the result. So the 
			following two statements in the context of an existing database
			result named "ATTRIBUTES" are equivalent:
			</p><pre class="programlisting">
				FOREACH ATTRIBUTES DO SELECT name FROM Company WHERE id = $ATTRIBUTES.id
				FOREACH ATTRIBUTES DO SELECT name FROM Company WHERE id = $id
			</pre><p>
			</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396696260"></a>Naming Database Results</h4></div></div></div><p>Database results can be hold and made referenceable by name
				with the declaration <code class="code">KEEP AS &lt;resultname&gt;</code>
				following immediately the instruction with the result to be referenced.
				The identifier &lt;resultname&gt; references the
				result in a variable reference or a FOREACH selector expression.
				</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396697684"></a>Named Result Example</h5></div></div></div><p>This example illustrates how a result is declared by name and referenced:
				</p><pre class="programlisting">
TRANSACTION selectDevices
BEGIN
    SELECT id FROM DevIdMap WHERE name = $(device/name);
    KEEP AS dev;
    FOREACH dev SELECT key,name,registration FROM Devices WHERE sid=$id;
END


				</pre><p>
				</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396699236"></a>Referencing Subroutine Parameters</h4></div></div></div><p>
				Subroutine Parameters are addressed like results but with
				the prefix <code class="code">PARAM.</code> instead of <code class="code">RESULT.</code>
				or a named result prefix. "PARAM." is reserved for parameters.
				The first instruction without FOREACH quantifier can reference
				the parameters without prefix by name.
				</p><pre class="programlisting">SUBROUTINE selectDevice( id)
BEGIN
	INTO device
		DO SELECT name FROM DevIdMap
			WHERE id = $PARAM.id;
END

TRANSACTION selectDevices
BEGIN
	DO selectDevice( id );
END

				</pre><p>
				</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396701396"></a>Constraints on database results</h4></div></div></div><p>Database commands returning results can have constraints to catch
			certain errors that would not be recognized at all or too late otherwise.
			For example a transaction having a result of a previous command as argument
			would not be executed if the result of the previous command is empty.
			Nevertheless the overall transaction would succeed because no database
			error occurring during execution of the commands defined for the 
			transaction.
			</p><p>
			Constraints on database results are expressed as keywords following
			the DO keyword of an instruction in the main processing section.
			</p><p>
			The following list explains the result constraints available:
			</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="code">NONEMPTY</code><p>Declares that the database result for each element of the input
					must not be empty.</p></li><li class="listitem"><code class="code">UNIQUE</code><p>Declares that the database result for each element of the input 
					must be unique, if it exists.
					Result sets with more than one element are refused 
					but empty sets are accepted. If you
					want to declare each result to have to exist, 
					you have to put the double constraint
					"UNIQUE NONEMPTY" or "NONEMPTY UNIQUE".</p></li></ul></div><p>
			</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396704684"></a>Example with Result Constraints</h5></div></div></div><p>
				This example illustrates how to add result constraint for
				database commands returning results:
				</p><pre class="programlisting">
				
TRANSACTION selectCustomerAddress
BEGIN
    DO NONEMPTY UNIQUE SELECT id FROM Customer
        WHERE name = $(customer/name);
    INTO address DO NONEMPTY SELECT street,city,country
        FROM Address WHERE id = $id;
END


				</pre><p>
				</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396706380"></a>Rewriting Error Messages for the Client</h4></div></div></div><p>Sometimes internal error messages are confusing and are not helpful
			to the user that does not have a deeper knowledge about the database
			internals. For a set of error types it is possible to add a message
			to be shown to the user if an error of a certain class happens.
			The instruction <code class="code">ON ERROR &lt;errorclass&gt; HINT &lt;message&gt;;</code>
			following a database instruction catches the errors of class &lt;errorclass&gt;
			and add the string &lt;message&gt; to the error message show to the user.
			</p><p>We can have many subsequent ON ERROR definitions in a row if the
			error classes to be caught are various.
			</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1396708124"></a>Database Error HINT Example</h5></div></div></div><p>The following example shows the usage HINTs in error cases. It
			catches errors that are constraint violations (error class CONSTRAINT)
			and extends the error message with a hint that will be shown to the client as error message:
			</p><pre class="programlisting">
			
TRANSACTION insertCustomer
BEGIN
    DO INSERT INTO Customer (name) VALUES ($(name));
    ON ERROR CONSTRAINT HINT ". Customers must have a unique name.";
END

			</pre><p>
			</p><p>
			On the client side the following message will be shown:
			</p><pre class="programlisting">unique constaint validation in transaction 'insertCustomer'. Customers must have a unique name.
			</pre><p>
			</p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396710700"></a>Substructures in the Result</h4></div></div></div><p>We already learned how to define substructures of the 
			transaction function result with
			the <code class="code">RESULT INTO</code> directive of an OPERATION or 
			TRANSACTION. But <code class="code">RESULT INTO</code> blocks can also be
			defined locally as sub blocks in the main processing block.
			A sub-block in the result is declared with 
			</p><pre class="programlisting">

				RESULT INTO &lt;resulttag&gt;
				BEGIN
					...&lt;instruction list&gt;...
				END
			</pre><p>
			All the results of the instruction list that get into the final result
			will be attached to the substructure with name &lt;resulttag&gt;.
			The nesting of result blocks can be arbitrary and the path of the 
			elements in the result follows the scope of the sub-blocks.
			</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1396713316"></a>Explicit Definition of Elements in the Result</h4></div></div></div><p>The result of a transaction consists normally of database command 
			results that are mapped into the result with the attached INTO directive.
			For printing variable values or constant values you can in certain
			SQL databases use a select constant statement without specifying a table.
			Unfortunately select of constants might not be supported in your 
			database of choice. Besides that explicit printing seems to be much
			more readable. The statement <code class="code">INTO &lt;resulttag&gt; PRINT &lt;value&gt;;</code>
			prints a value that can be a constant, variable or an input or result reference
			into the substructure named &lt;resulttag&gt;. The following artificial 
			example illustrates this.
			</p><pre class="programlisting">
			
TRANSACTION doPrintX
RESULT INTO person
BEGIN
    INTO name PRINT 'jussi';
    INTO id PRINT '1';
END

			</pre><p>
			</p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1396760404"></a>3.2. Functions in .NET</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396760724"></a>3.2.1. Introduction</h3></div></div></div><p>You can write functions for the logic tier of <span class="application">Wolframe</span> in languages based
		on <span class="application">.NET</span> (<a class="ulink" href="http://www.microsoft.com/net" target="_top">http://www.microsoft.com/net</a>) like for example
		<span class="application">C#</span> and <span class="application">VB.NET</span>.  
		Because <span class="application">.NET</span> based libraries can only be called 
		by <span class="application">Wolframe</span> only as a 
		compiled and not as an interpreted language, you have to build a module out of your function 
		implementation.
		</p><p>
		The implementation of <span class="application">.NET</span> calls is not yet available.
		The implementation exists as prove of concept in a test program. 
		But <span class="application">Wolframe</span> will provide
		<span class="application">.NET</span> functions soon.
		</p></div><p></p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1396752700"></a>3.3. Functions in Python</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396753044"></a>3.3.1. Introduction</h3></div></div></div><p>You can write functions for the logic tier of <span class="application">Wolframe</span> in the 
		<span class="application">Python</span> programming language (<a class="ulink" href="http://www.python.org" target="_top">http://www.python.org</a>).
		</p><p>
		The implementation of <span class="application">Python</span> calls is not yet available. 
		But <span class="application">Wolframe</span> will provide <span class="application">Python</span> functions soon.
		</p></div><p></p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1396760172"></a>3.4. Functions in Lua</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396759028"></a>3.4.1. Introduction</h3></div></div></div><p>You can write functions for the logic tier of <span class="application">Wolframe</span> with <span class="application">Lua</span>. <span class="application">Lua</span> is a scripting language designed, implemented, and maintained
		at PUC-Rio in Brazil by Roberto Ierusalimschy, Waldemar Celes and Luiz Henrique de Figueiredo
		(see <a class="ulink" href="http://www.lua.org/authors.html" target="_top">http://www.lua.org/authors.html</a>). A description of <span class="application">Lua</span> is not provided here.
		For an introduction into programming with <span class="application">Lua</span> see <a class="ulink" href="http://www.lua.org" target="_top">http://www.lua.org</a>. The official manual which is also available as book
		is very good. <span class="application">Wolframe</span> introduces some <span class="application">Lua</span> interfaces to access input and output and to execute functions.
		The <span class="application">Lua</span> application layer does not have to deal with protocol or encryption issues.
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396812700"></a>3.4.2. Declaring Functions</h3></div></div></div><p>For <span class="application">Lua</span> you do not have to declare anything in addition to the <span class="application">Lua</span> script. If you configure a <span class="application">Lua</span>
		script as program, all global functions declared in this script are declared as form
		functions in <span class="application">Wolframe</span>. For avoiding name conflicts you should declare private functions
		of the script as <code class="code">local</code>.
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396814988"></a>3.4.3. Wolframe Provider Library</h3></div></div></div><p><span class="application">Wolframe</span> lets you access objects of the global context through
		a library called <code class="code">provider</code> offering the following functions:

		</p><table border="0" summary="Simple list" class="simplelist"><tr><td>Name</td><td>Parameter</td><td>Returns</td></tr><tr><td>form</td><td>name of the form</td><td>an instance of a form</td></tr><tr><td>normalizer</td><td>name of the normalize function</td><td>normalize function defined in a <span class="application">Wolframe</span> normalizer program</td></tr><tr><td>formfunction</td><td>name of the function</td><td>form function defined in a <span class="application">Wolframe</span> program or module</td></tr></table><p>
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396819060"></a>3.4.4. Wolframe Global Objects</h3></div></div></div><p>Besides the provider library <span class="application">Wolframe</span> defines the following objects global in the script execution context:
		</p><table border="0" summary="Simple list" class="simplelist"><tr><td>Name</td><td>Description</td></tr><tr><td>transaction</td><td>transaction context if not relying on the auto-commit of a transaction function</td></tr><tr><td>scope</td><td>function with an iterator as argument returning an iterator for iterating on the currently visited node and its children taking ownership on this sub iterator scope</td></tr><tr><td>logger</td><td>object with methods for logging or debugging</td></tr></table><p>
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396822100"></a>3.4.5. Using Forms</h3></div></div></div><p>The provider function <code class="code">provider.form( )</code> with the name of the form as string as parameter returns an empty
		instance of a form. It takes the name of the form as string argument.
		If you for example have a form configured called "employee" and you want to create an
		employee object from a <span class="application">Lua</span> table, you call
			</p><pre class="programlisting">
			
bcf = provider.form( "employee" )
bcf:fill( {surname='Hans', name='Muster', company='Wolframe'} )

			</pre><p>
		The first line creates the data form object.
		The second line fills the data into the data form object.
		</p><p>

		The form method <code class="code">fill</code> takes a second optional parameter. Passing "strict" as
		second parameter enforces a strict validation of the input against the form, meaning that
		attributes are checked to be attributes (when using XML serialization) and non optional elements are checked to be initialized.
		Passing "complete" as second parameter forces non optional elements to be checked for initialization
		but does not distinguish between attributes and content values. "relaxed" is the default and
		checks only the existence of filled-in values in the form.
		</p><p>
		Given the following validation form:
			</p><pre class="programlisting">
			
FORM Employee
{
   employee
   {
       ID !@int                  ; Internal customer id (mandatory)
       name !string              ; Name of the customer (mandatory)
       company string            ; Company he is working for (optional)
   }
}

			</pre><p>

		the call of <code class="code">fill</code> in the following piece of code will raise an error because some elements
		of the form ('ID' and 'name') are missing in the input:
			</p><pre class="programlisting">
			
bc = provider.form( "employee" ):fill( {company='Wolframe'}, "strict" )

			</pre><p>
		</p><p>
		To access the data in a form there are two form methods available. <code class="code">get()</code> returns an iterator on the form data similar
		to the iterator on input. Same as for input there is a method <code class="code">value()</code> that returns the form data as <span class="application">Lua</span> data structure
		(a <span class="application">Lua</span> table or atomic value).
		</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396829220"></a>3.4.6. Form Functions</h3></div></div></div><p>
		For calling transactions or built-in functions loaded as modules the <span class="application">Lua</span> layer defines the
		concept of functions. The provider function <code class="code">provider.formfunction</code> with the name of the function
		as argument returns a <span class="application">Lua</span> function. This function takes a table or an iterator as argument
		and returns a data form structure. The data in the returned form data structure can be
		accessed with <code class="code">get()</code> that returns an iterator on the content and <code class="code">value()</code>
		that returns a <span class="application">Lua</span> table or atomic value.
		</p><p>
		If you for example have a transaction called "insertEmployee" defined in a transaction description program
		file declared in the configuration called "insertEmployee" and you want to call it with the 'employee'
		object defined above as input, you do
			</p><pre class="programlisting">
			
f = provider.formfunction( "insertEmployee")
res = f ( {surname='Hans', name='Muster', company='Wolframe'} )
t = res:value()
output:print( t[ "id" ] )

			</pre><p>
		</p><p>
		The first line creates the function called "insertEmployee" as <span class="application">Lua</span> function.
		The second calls the transaction, the third creates a <span class="application">Lua</span> table out of the result
		and the fourth selects and prints the "id" element in the table.
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396834220"></a>3.4.7. List of <span class="application">Lua</span> Objects</h3></div></div></div><p>This is a list of all objects and functions declared by Wolframe:</p><div class="table"><a id="idp1396835116"></a><p class="title"><strong>Table 3.1. Data forms declared by DDL</strong></p><div class="table-contents"><table summary="Data forms declared by DDL" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Method Name</th><th>Arguments</th><th>Returns</th><th>Description</th></tr></thead><tbody><tr><td>get</td><td> </td><td>iterator (*)</td><td>Returns an iterator on the form elements</td></tr><tr><td>value</td><td> </td><td><span class="application">Lua</span> table</td><td>Returns the contents of the data form as <span class="application">Lua</span> table or atomic value</td></tr><tr><td>__tostring</td><td> </td><td>string</td><td>String representation of form for debugging</td></tr><tr><td>name</td><td> </td><td>string</td><td>Returns the global name of the form.
					</td></tr><tr><td>fill</td><td><span class="application">Lua</span> table or iterator (*), optional validation mode (**)</td><td>the filled form (for concatenation)</td><td>Validates input and fills the input data into the form.</td></tr></tbody></table></div></div><br class="table-break" /><p>
			(*) With iterator we mean an iterator as introduced in previous sections, returned by a Wolframe <span class="application">Lua</span> object 'get()' method.
		</p><p>
			(**) "strict" (full validation), "complete" (only check for all non optional elements initialization) or "relaxed" (no validation except matching of input to elements)
		</p><div class="table"><a id="idp1396844052"></a><p class="title"><strong>Table 3.2. Data forms returned by functions</strong></p><div class="table-contents"><table summary="Data forms returned by functions" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Method Name</th><th>Returns</th><th>Description</th></tr></thead><tbody><tr><td>get</td><td>iterator (*)</td><td>Returns an iterator on the form elements</td></tr><tr><td>value</td><td><span class="application">Lua</span> table or atomic value</td><td>Returns the contents of the data form as <span class="application">Lua</span> table or atomic value</td></tr><tr><td>__tostring</td><td>string</td><td>String representation of form for debugging</td></tr></tbody></table></div></div><br class="table-break" /><p>
			(*) With iterator we mean an iterator as introduced in previous sections, returned by a Wolframe <span class="application">Lua</span> object 'get()' method.
		</p><div class="table"><a id="idp1396849804"></a><p class="title"><strong>Table 3.3. Global Transaction Context</strong></p><div class="table-contents"><table summary="Global Transaction Context" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Method Name</th><th>Description</th></tr></thead><tbody><tr><td>transaction.begin</td><td>Starts a transaction</td></tr><tr><td>transaction.commit</td><td>Commit of a transaction</td></tr><tr><td>transaction.rollback</td><td>Rollback of a transaction</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp1396853428"></a><p class="title"><strong>Table 3.4. Logger functions</strong></p><div class="table-contents"><table summary="Logger functions" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Method Name</th><th>Arguments</th><th>Description</th></tr></thead><tbody><tr><td>logger.printc</td><td>arbitrary list of arguments</td><td>Print arguments to standard console output</td></tr><tr><td>logger.print</td><td>loglevel (string) plus arbitrary list of arguments</td><td>log argument list with defined log level</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idp1396857204"></a><p class="title"><strong>Table 3.5. Global functions</strong></p><div class="table-contents"><table summary="Global functions" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Function Name</th><th>Arguments</th><th>Description</th></tr></thead><tbody><tr><td>provider.form</td><td>name of form (string)</td><td>Returns an empty data form object of the given type</td></tr><tr><td>provider.formfunction</td><td>name of function (string)</td><td>Returns a lua function to execute the <span class="application">Wolframe</span> function specified by name</td></tr><tr><td>provider.normalizer</td><td>type name</td><td>Returns a <span class="application">Lua</span> function for normalizing values of the type specified (as used in forms)</td></tr><tr><td>scope</td><td>iterator (*)</td><td>Returns an iterator to iterate till the end of the current tag (**)</td></tr></tbody></table></div></div><br class="table-break" /><p>
			(*) With iterator we mean an iterator as introduced in previous sections, returned by a <span class="application">Wolframe</span> <span class="application">Lua</span> object 'get()' method.
		</p><p>
			(**) The iterator of a defined scope must be consumed completely before consuming anything of the parent iterator.
			Otherwise it may lead to unexpected results because they share some part of the iterator state.
		</p></div><p></p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1396896364"></a>3.5. DDL Data Types</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396896708"></a>3.5.1. Introduction</h3></div></div></div><p>Forms defined by DDLs are typed. The only predefined type is 'string' that is neither
		validated nor transformed for processing in any way. The types that can be used in DDLs are
		defined in files with the extension ".wnmp" and defined as programs in the configuration.
	</p><p>
		A .wnmp file contains assignments of a type name to sequences of normalization
		function calls where the first takes the initial input. The output of a function
		in the sequence gets the input of the next one and the final output for the last one.
		Each normalization step validates the input as atomic type (arithmetic,string,etc.)
		and transforms it to another atomic type.
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396885620"></a>3.5.2. Example</h3></div></div></div><p>
		The example defines 3 numeric types including trimming of the input string for mode tolerant
		parsing and a string type that is converted to lowercase as normalization.
	</p><p>
		</p><pre class="programlisting">
		
int=string:trim,number:integer;
uint=string:trim,number:unsigned;
float=string:trim,number:float;
name=string:trim,lcname;

		</pre><p>
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396929708"></a>3.5.3. Language Description</h3></div></div></div><p>
		Each type declaration in a <code class="code">.wnmp</code> file starts with an identifier followed by an assignment 
		operator '='. The left side identifier specifies the name of the type. This type name can be used
		in a DDL as name instead of the built in type <code class="code">string</code>. When doing so the referenced token is validated
		and normalized with the comma separated sequence of function references on the right side of 
		the assignment before being assigned as value to the element in the form declared to be of this type.
	</p><p>
		The function names are either identifiers or have two parts separated by ':'. The left part is the name
		of the module declaring the function. The right part is the name of the function 
		in the module with the name in front of the ':'. If the function is 
		declared as one single identifier then the module referred to is the previous one in the sequence 
		before the identifier. The 4th line in the example declaration list above
		for example refers to the 'lcname' function in the 'string' normalization module.
	</p><p>Functions can have a comma separated list of constant arguments in brackets ('(' and ')') 
		depending on the function type. An integer type for example could have 
		the maximum number of digits of the integer type.
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396932324"></a>3.5.4. Configuration</h3></div></div></div><p>For declaring and using a .wnmp file in our example above, you have to load the module 'mod_normalize_string'
	and the module 'mod_normalize_number'.
	For this you add the following two lines to the LoadModules section of your <span class="application">Wolframe</span> configuration:
		</p><pre class="programlisting">
		
    module mod_normalize_number
    module mod_normalize_string


		</pre><p>
	</p><p>You also have to add the declaration of the program "example.wnmp" (listing example above) 
	to the Processor section of the configuration.
	</p><pre class="programlisting">
	
    program example.wnmp

	</pre><p>
	</p></div><p></p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1396893860"></a>3.6. Functions in C++</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396894204"></a>3.6.1. Introduction</h3></div></div></div><p>You can write functions for the logic tier of <span class="application">Wolframe</span> with <span class="application">C++</span>. 
		Because <span class="application">C++</span> is supported by <span class="application">Wolframe</span> only as a compiled and not as 
		an interpreted language, you have to build a module out of your function implementation.
		</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396895892"></a>3.6.2. Declaring Functions</h3></div></div></div><p>
		...
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1396890572"></a>3.6.3. Input/Output Data Structures</h3></div></div></div><p>For defining input and output parameter structures in <span class="application">C++</span> you have to define the 
		structure and its serialization description. The serialization description is a static 
		function <code class="code">getStructDescription</code> without arguments returning a const structure that describes 
		what element names to bind to which structure elements.
	</p><p>
		The following example shows a form function parameter structure defined in C++.
		</p><div class="sect3"><div class="titlepage"></div><p>Header file "customers.hpp": Declare the structure and the serialization description of the structure.
		Structures may contain structures with their own serialization description.</p><pre class="programlisting">
		
#include "serialize/struct/filtermapBase.hpp"
#include &lt;string&gt;

namespace _Wolframe {
namespace example {

struct Customer
{
       int ID;                         // Internal customer id
       std::string name;               // Name of the customer
       std::string canonical_Name;     // Customer name in canonical form
       std::string country;            // Country
       std::string locality;           // Locality

       static const serialize::StructDescriptionBase* getStructDescription();
};

}}//namespace


		</pre></div><p>
		</p><div class="sect3"><div class="titlepage"></div><p>Source file "customers.cpp". Declare 'ID' as attribute and name, canonical_Name, country, locality as tags. The '--' operator marks the end of attributes section and the start of content section.</p><pre class="programlisting">
		
#include "serialize/struct/filtermapDescription.hpp"

using namespace _Wolframe;

namespace {
struct CustomerDescription :public serialize::StructDescription&lt;Customer&gt;
{
	CustomerDescription()
	{
		//
		(*this)
		("ID", &amp;Customer::ID)
		--
		("name", &amp;Customer::name)
		("canonical_Name", &amp;Customer::canonical_Name)
		("country", &amp;Customer::country)
		("locality", &amp;Customer::locality)
		;
	}
};

const serialize::StructDescriptionBase* Customer::getStructDescription()
{
	static CustomerDescription rt;
	return &amp;rt;
}


		</pre></div><p>
	</p></div><p></p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397053844"></a>Chapter 4. Forms</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="sect1"><a href="#idp1397100548">4.1. Form Data Definition Languages</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397100868">4.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397091228">4.1.2. Forms in Simpleform DDL</a></span></dt></dl></dd></dl></div><p>
Forms are data structures used to validate input and output data and to do some basic normalization
in order to make data accessible in a uniform way. Forms are defined in a data definition language
(<acronym class="acronym">DDL</acronym>) and translated by a compiler at startup. Those compilers are defined as loadable
modules.
</p><p>
This chapter describes how form data schemas are linked to the logic tier. It introduces a data description
language (<acronym class="acronym">DDL</acronym>) called <code class="code">simpleform</code> that allows you to specify data schemas with the validation and 
normalization of atomic types. It also describes the <span class="application">Wolframe</span> module concept for form descriptions that 
allows you to add a compiler for your existing data schemas.
</p><p>
After reading this chapter you should be able to write data forms of <span class="application">Wolframe</span> of the  logic tier 
in the <code class="code">simpleform</code> data description language on your own. You should also know how a new data description
language (<acronym class="acronym">DDL</acronym>) could be added.
</p><p>
Be aware that you have to configure a data description language type (<acronym class="acronym">DDL</acronym> compiler) of the logic tier 
in <span class="application">Wolframe</span> before using it. Each chapter introducing a data form description language will have 
a section that describes how the server configuration of <span class="application">Wolframe</span> has to be extended for its availability.
</p><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1397100548"></a>4.1. Form Data Definition Languages</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397100868"></a>4.1.1. Introduction</h3></div></div></div><p>
		Form data structures can be defined in a <acronym class="acronym">DDL</acronym> (Data Definition Language).
		It depends very much on the application what <acronym class="acronym">DDL</acronym> is best to use.
		Users may already have their data definitions defined in a certain way.
		The form <acronym class="acronym">DDL</acronym> can be defined in the way you want. Wolframe offers a
		plugin mechanism for <acronym class="acronym">DDL</acronym> compilers and provides examples of such compilers.
		You configure the <acronym class="acronym">DDL</acronym> sources to load and the compiler to use.
	</p><p>
		With the <acronym class="acronym">DDL</acronym> form description we get a deserialization of some content
		into a structure and a serialization for the output. We get also a validation
		and normalization procedure of the content by assigning types to atomic form
		elements that validate and normalize the data elements.
		Most of the business transactions should be doable as input form
		description, output form description and a transaction that maps
		input to output without control flow aware programming (direct map).
	</p><p>
		All types of data forms introduced here are equivalent in use for all programs.
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397091228"></a>4.1.2. Forms in Simpleform DDL</h3></div></div></div><p>
		As example of a form <acronym class="acronym">DDL</acronym> we provide the <em class="glossterm">simpleform</em> <acronym class="acronym">DDL</acronym>. The format is based on the "INFO"-format
		introduced by Marcin Kalicinski for the boost property tree library. We used this library to show an example
		that is easy to understand and small enough.
		The format uses key value pairs separated with spaces for atomic elements and curly brackets '{' '}' to describe structures.
		The key represents the name of the element and the value represents the type of the element.
		The type is defined by a typename and some operators that describe additional properties.
	</p><p>
		Each form declaration starts with a keyword 'FORM' or 'STRUCT'. The difference between 'FORM' and 'STRUCT' is that the later is used for declarations that are only referenced inside the same file as sub structure reference,
		while 'FORM' declares a structure to be exported as global form declaration.
		This header is followed by the structure declaration inside curly brackets '{' '}'.
	</p><p>
		There is only one predefined data type known in <em class="glossterm">simpleform</em> <acronym class="acronym">DDL</acronym>: "string".
		All other data types are defined as sequence of 'normalizer' functions in a normalize definition file.
		The 'normalizer' functions assigned to a type validate the value and transform it to its normalized form.
	</p><p>
		The following element attributes are known in <em class="glossterm">simpleform</em> <acronym class="acronym">DDL</acronym>:
		
		</p><div class="table"><a id="idp1397137252"></a><p class="title"><strong>Table 4.1. element attributes in simpleform</strong></p><div class="table-contents"><table summary="element attributes in simpleform" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Attribute</th><th>Location</th><th>Description</th></tr></thead><tbody><tr><td>@</td><td>prefix of data type</td><td>Expresses that the element is an attribute and not a content element of the structure. This has only influence on the XML or similar representation of the form content</td></tr><tr><td>?</td><td>prefix of data type</td><td>Expresses that the element is optional also in strict validation</td></tr><tr><td>^</td><td>prefix of form name</td><td>Expresses that the element is optional and refers to a structure defined in the same module that is expanded only if the element is present. With this construct it is possible to define recursive structures like trees.</td></tr><tr><td>!</td><td>prefix of data type</td><td>Expresses that the element is always mandatory (also in non strict validation)</td></tr><tr><td>[]</td><td>prefix of data type</td><td>Expresses that the element is an array of this type</td></tr><tr><td>[]</td><td>without data type</td><td>Expresses this element is an array of structures and that the structure defined describes the prototype (initialization) element of the array.</td></tr><tr><td>(..)</td><td>postfix of data type</td><td>Expresses that '..' (represents any valid value not containing brackets) is the default initialization value of this element.</td></tr></tbody></table></div></div><p><br class="table-break" />
	</p><p>
		Using a single underscore as typename ('_') means that element is embedded into the structure
		without being referenceable by name. In case of an atomic value it means that value represents the
		content value of the structure. In case of a substructure it means that the structure inherits
		the embedded elements of the substructure.
	</p><p>
		The following example shows a form defined in <em class="glossterm">simpleform</em> <acronym class="acronym">DDL</acronym>.
		</p><pre class="programlisting">
		
FORM Customer
{
   customer
   {
       ID !@int                  ; Internal customer id (mandatory)
       name string               ; Name of the customer
       canonical_Name string     ; Customer name in canonical form
       country string            ; Country
       locality ?string          ; Locality (optional)
   }
}

		</pre><p>
	</p></div><p></p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397124932"></a>Chapter 5. Filters</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="sect1"><a href="#idp1397167828">5.1. XML Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397168164">5.1.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397201108">5.1.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397206340">5.1.3. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1397167420">5.2. JSON Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397179660">5.2.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397171236">5.2.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397193204">5.2.3. Configuration</a></span></dt></dl></dd><dt><span class="sect1"><a href="#idp1397176380">5.3. XSLT Filter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397176716">5.3.1. Introduction</a></span></dt><dt><span class="sect2"><a href="#idp1397172916">5.3.2. Character Set Encodings</a></span></dt><dt><span class="sect2"><a href="#idp1397229220">5.3.3. Configuration</a></span></dt></dl></dd></dl></div><p>
Filters describe the transformation of serialized data to a unified serialization of hierarchical structured data and back.
The application does not care about data formats as long as there exists a filter providing
the unified form of serialization.
</p><p>
This chapter describes how filters for different data formats are linked to the logic tier. For each data format
supported by <span class="application">Wolframe</span> one or more filter type is introduced. 
</p><p>
After reading this chapter you should be able to handle different document formats and encodings 
in the logic tier of <span class="application">Wolframe</span>. You will know how to add programs for scriptable filters
like <acronym class="acronym">XSLT</acronym>.
</p><p>
Be aware that you have to configure a data filter of the logic tier in <span class="application">Wolframe</span> before using it.
Each chapter introducing a filter type will have a section that describes how the server configuration 
of <span class="application">Wolframe</span> has to be extended for its availability.
</p><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1397167828"></a>5.1. XML Filter</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397168164"></a>5.1.1. Introduction</h3></div></div></div><p>You can use <acronym class="acronym">TDL</acronym> for data filters in the logic tier of <span class="application">Wolframe</span>.
	There are the following variants of <acronym class="acronym">TDL</acronym> filters available:
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">libxml2</span> (<a class="ulink" href="http://www.xmlsoft.org" target="_top">http://www.xmlsoft.org</a>) or</p></li><li class="listitem"><p><span class="application">textwolf</span> (<a class="ulink" href="http://www.textwolf.net" target="_top">http://www.textwolf.net</a>)</p></li></ul></div><p>	
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397201108"></a>5.1.2. Character Set Encodings</h3></div></div></div><p>The <span class="application">libxml2</span> and the <span class="application">textwolf</span> filter support at least 
	the following character set encodings. For character set encodings that are not in the list, 
	please ask the <span class="application">Wolframe</span> team.
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><abbr class="abbrev">UTF-8</abbr> or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-16LE</abbr> or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-16</abbr> (<abbr class="abbrev">UTF-16BE</abbr>) or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-32LE</abbr> (<abbr class="abbrev">UCS-4LE</abbr>) but only with <span class="application">textwolf</span> or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-32</abbr> (<abbr class="abbrev">UTF-32BE</abbr> or <abbr class="abbrev">UCS-4BE</abbr>) or</p></li><li class="listitem"><p><abbr class="abbrev">ISO 8859</abbr> (code pages '1' to '9')</p></li></ul></div><p>
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397206340"></a>5.1.3. Configuration</h3></div></div></div><p>For using an <acronym class="acronym">XML</acronym> filter based <span class="application">libxml2</span>, you have to load the module 'mod_filter_libxml2'.
	For this you add the following line to the LoadModules section of your <span class="application">Wolframe</span> configuration:
		</p><pre class="programlisting">
		
    module mod_filter_libxml2


		</pre><p>
	</p><p>
	For using an <acronym class="acronym">XML</acronym> filter based <span class="application">textwolf</span>, you have to load the module 'mod_filter_textwolf'.
	For this you add the following line to the LoadModules section of your <span class="application">Wolframe</span> configuration:
		</p><pre class="programlisting">
		
    module mod_filter_textwolf

		</pre><p>
	</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1397167420"></a>5.2. JSON Filter</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397179660"></a>5.2.1. Introduction</h3></div></div></div><p>You can use <span class="application">JSON</span> for data filters in the logic tier of <span class="application">Wolframe</span>.
	The standard <span class="application">JSON</span> filter of <span class="application">Wolframe</span> is called <span class="application">cjson</span> and 
	based on the library <span class="application">cJSON</span> (<a class="ulink" href="http://sourceforge.net/projects/cjson" target="_top">http://sourceforge.net/projects/cjson</a>) from Dave Gamble.
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397171236"></a>5.2.2. Character Set Encodings</h3></div></div></div><p>Without explicitly specified, the <span class="application">cjson</span> filter support the following character set 
	encodings. For character set encodings that are not in the list, please ask the <span class="application">Wolframe</span> team.
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><abbr class="abbrev">UTF-8</abbr> or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-16LE</abbr> or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-16</abbr> (<abbr class="abbrev">UTF-16BE</abbr>) or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-32LE</abbr> (<abbr class="abbrev">UCS-4LE</abbr>) or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-32</abbr> (<abbr class="abbrev">UTF-32BE</abbr> or <abbr class="abbrev">UCS-4BE</abbr>) or</p></li></ul></div><p>
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397193204"></a>5.2.3. Configuration</h3></div></div></div><p>For using the JSON filter based <span class="application">cJSON</span>, you have to load the module 'mod_filter_cjson'. 
	For this you add the following line to the LoadModules section of your <span class="application">Wolframe</span> configuration:
		</p><pre class="programlisting">
		
    module mod_filter_cjson

		</pre><p>
	</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1397176380"></a>5.3. XSLT Filter</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397176716"></a>5.3.1. Introduction</h3></div></div></div><p>You can use <acronym class="acronym">XSLT</acronym> for data filters in the logic tier of <span class="application">Wolframe</span>.
	The <acronym class="acronym">XSLT</acronym> filter of <span class="application">Wolframe</span> for is based on <span class="application">libxml2</span> 
	(<a class="ulink" href="http://www.xmlsoft.org" target="_top">http://www.xmlsoft.org</a>).
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397172916"></a>5.3.2. Character Set Encodings</h3></div></div></div><p>Without explicitly specified, the <acronym class="acronym">XSLT</acronym> filter support the following character set 
	encodings. For character set encodings that are not in the list, please ask the <span class="application">Wolframe</span> team.
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><abbr class="abbrev">UTF-8</abbr> or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-16LE</abbr> or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-16</abbr> (<abbr class="abbrev">UTF-16BE</abbr>) or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-32LE</abbr> (<abbr class="abbrev">UCS-4LE</abbr>) or</p></li><li class="listitem"><p><abbr class="abbrev">UTF-32</abbr> (<abbr class="abbrev">UTF-32BE</abbr> or <abbr class="abbrev">UCS-4BE</abbr>) or</p></li></ul></div><p>
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397229220"></a>5.3.3. Configuration</h3></div></div></div><p>For using an XSLT filter based <span class="application">libxml2</span>, you have to load the module 'mod_filter_libxml2'.
	For this you add the following line to the LoadModules section of your <span class="application">Wolframe</span> configuration:
		</p><pre class="programlisting">
		
    module mod_filter_libxml2


		</pre><p>
	</p><p>You also have to add the program of the XSLT filter into the Processor section of the configuration.
	The name of the filter is the filename of the XSLT filter program without path and extension. In our example
	the filter would be named invoice_ISOxxxx:
	</p><pre class="programlisting">
	
    program invoice_ISOxxxx.xslt

	</pre><p>
	</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397075588"></a>Chapter 6. Testing and Defect Handling</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="sect1"><a href="#idp1397073052">6.1. Using wolfilter</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397078028">6.1.1. Testing a Filter</a></span></dt><dt><span class="sect2"><a href="#idp1397277004">6.1.2. Testing a Form</a></span></dt><dt><span class="sect2"><a href="#idp1397278348">6.1.3. Testing a Function</a></span></dt></dl></dd></dl></div><p>In this chapter we learn how parts of a <span class="application">Wolframe</span>
application can be verified to work correctly. The basis for testing and debugging
a <span class="application">Wolframe</span> application is the command line tool 
<span class="application">wolfilter</span>. 
</p><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1397073052"></a>6.1. Using wolfilter</h2></div></div></div><p>The command line program <span class="application">wolfilter</span> allows you to call any
	<span class="application">Wolframe</span> function or filter or mapping into a form structure
	on command line.
	</p><p>
	There are two possibilities to declare the items involved in the test.
	Either you pass the configuration with the option '--config' and the name of the command
	to execute or you declare the items one by one with program options. These two approaches
	are not mixable. Either you use '--config' or pass the parameters one by one. 
	A try to mix both of them in one call is refused by <span class="application">wolfilter</span>.
	</p><p>The following examples assume the input file name to be in.xml or in.json and
	the output file to be named out.xml or out.json respectively.
	</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397078028"></a>6.1.1. Testing a Filter</h3></div></div></div><p>The following example shows the mapping through a libxml2 filter.
		Filters are tested by passing a dash '-' command to execute.
		</p><pre class="programlisting">

		cat in.xml | wolfilter -f libxml2 -m mod_filter_libxml2 - &gt; out.xml
		</pre><p>
		</p><p>The following example shows the processing of the input
		through an xslt filter and mapping the output through a token filter
		that shows the tokenization of the input by the input filter.
		</p><pre class="programlisting">

		cat in.xml | wolfilter -i myfilter -o token\
			-m mod_filter_libxml2\
			-m mod_filter_token\
			-p myfilter.xslt - &gt; out.xml
		</pre><p>
		</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397277004"></a>6.1.2. Testing a Form</h3></div></div></div><p>The following example shows the mapping through a form defined with simpleform DDL.
		Mapping through forms is tested by passing the name of the form as command to execute.
		</p><pre class="programlisting">

		cat in.xml | wolfilter -f libxml2 \
			-m mod_filter_libxml2\
			-p myform.sfrm MyForm &gt; out.xml
		</pre><p>
		we assume here that the form to use is defined in myform.sfrm and called MyForm.
		</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397278348"></a>6.1.3. Testing a Function</h3></div></div></div><p>The following example shows the execution of a function written in Lua.
		A JSON filter is used for input and output.
		</p><pre class="programlisting">

		cat in.xml | wolfilter -f cjson \
			-m mod_filter_cjson -m mod_command_lua \
			-m mod_command_directmap
			-p myfunc.lua MyFunc &gt; out.json
		</pre><p>
		we assume here that the exported function to call defined in myfunc.lua is called MyFunc.
		</p></div></div></div><div class="glossary"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397256820"></a>Glossary</h1></div></div></div><p>
		This is the glossary for the Wolframe Service Development Kit. Although it
		covers most of the terms used in the Wolframe world, some terms might be skipped
		if they are rarely used in the SDK context. These terms are explained in the
		Application Building Manual
	</p><p>
		This is the glossary for the Wolframe Application Building Manual.
		It covers most of the terms used in a Wolframe application,
		although some of the terms might be found only in the SDK manual.
	</p><div class="glossdiv"><h3 class="title">External glossary</h3><dl><dt><a id="DDL"></a><span class="glossterm">Data Definition Language</span></dt><dd class="glossdef"><p>A domain specific language for describing data structures</p></dd></dl></div><div class="glossdiv"><h3 class="title">Wolframe glossary</h3><dl><dt><span class="glossterm">Connection Handler</span></dt><dd class="glossdef"><p>Interface for the networking to one client/server connection during its whole lifetime.
			</p></dd><dt><span class="glossterm">Command Handler</span></dt><dd class="glossdef"><p>Interface for delegating processing of client protocol commands in a hierarchical way. A command handler is created by a connection handler or another command handler. During command execution the input/output of the connection is entirely handled by the command handler. Command Handlers are used to build the communication protocol processing as hierarchical state machine.
			</p></dd><dt><span class="glossterm">Network Input</span></dt><dd class="glossdef"><p>Data passed from the networking framework to the connection handler through its channel for processing.
			</p></dd><dt><span class="glossterm">Network Output</span></dt><dd class="glossdef"><p>Data passed back through the channel to the networking framework from the connection handler as output of processing.
			</p></dd><dt><span class="glossterm">Program</span></dt><dd class="glossdef"><p>A set of named units of description of processing or data in a source file. The source file is loaded and interpreted at server startup. It exports some unique symbols to address single units in a program library. All units in this library are usable in any context of the logic tier.
			</p></dd><dt><span class="glossterm">Transaction</span></dt><dd class="glossdef"><p>A transaction is a call of a database defined in a transaction program. A transaction either fails completely or succeeds as whole. Auditing is seen as part of the transaction. Transactions have an object as input and return an object or an error as result.
				Authorization tags that are checked against the user privileges of the connection can be attached to transactions.
			</p></dd><dt><span class="glossterm">Processor program</span></dt><dd class="glossdef"><p>A program that is executed by a command handler. It works with data input, data output and transaction execution as the only interfaces to the system. Exceptions, signals and events are handled by the processor in the background without showing them to the program. A program in this context is sequential.
			</p></dd><dt><span class="glossterm">Lua</span></dt><dd class="glossdef"><p>Lua (www.lua.org) is a scripting language. It is used in Wolframe as one language for writing programs. It distinguishes itself by being lightweight. It has to be lightweight because the language context has to be recreated with every start of a clients command execution for security reasons.
			</p></dd><dt><span class="glossterm">Filter</span></dt><dd class="glossdef"><p>Filters are attached to network input and output to read and write input in a well defined format. Filters let you process input and print output in an iterative way. Filters are loaded by the system at startup and have a unique name.
			</p></dd><dt><span class="glossterm">Form</span></dt><dd class="glossdef"><p>A form is a hierarchical description of typed data. Forms are used to create objects from a serialization and to validate input. Forms are defined in programs written in a DDL (Data Definition Language) or as declared as part of a build-in function API.
			</p></dd><dt><span class="glossterm">Direct Map</span></dt><dd class="glossdef"><p>A direct map is a program described by a form for the input, a form for the output, and a transaction function. The input of a direct map transaction function is the object deserialization of the input xml defined by the input form. The result of the transaction function is returned as xml serialization of the transaction result defined by the output form. It is called direct map because no scripting is involved in this case.
			</p></dd><dt><span class="glossterm">Channel</span></dt><dd class="glossdef"><p>The flow for a single connection. Not all objects have channels (e.g. databases).
			</p></dd><dt><span class="glossterm">Group</span></dt><dd class="glossdef"><p>A set of objects of the same type seen as one single object for the objects that use it.
			</p></dd><dt><span class="glossterm">Unit</span></dt><dd class="glossdef"><p>An element of a group. A group is a set of units.
			</p></dd><dt><span class="glossterm">Provider</span></dt><dd class="glossdef"><p>An entity providing objects of a kind. Some providers are factories, but not all of them (e.g. the database provider)
			</p></dd><dt><a id="EoD"></a><span class="glossterm">End Of Data (EoD)</span></dt><dd class="glossdef"><p>Marks the end of the data to be processed by a processor. End of data is marked with CR LF dot ('.') CR LF or LF dot LF. For passing lines with a dot ('.') at the start of a content line, the client has to escape an LF dot in the content with LF dot dot. This escaping applies also to the result returned to the client. So client has to unescape LF dot sequences by replacing them by a LF.
			</p></dd><dt><a id="EoM"></a><span class="glossterm">End Of Message (EoM)</span></dt><dd class="glossdef"><p>Marks the end of a network input message. End of message is handled by the processor without showing up to the processor program (yield execution).
			</p></dd><dt><span class="glossterm">Application Reference Path</span></dt><dd class="glossdef"><p>The application server defines this file path where all relative paths defined in the configuration refer to.
			</p></dd><dt><span class="glossterm">Yield execution</span></dt><dd class="glossdef"><p>The processor yields execution and gives control back to the connection handler, when it cannot continue execution. The connection handler has to resume with an action returned to the networking framework, that fetches the resources needed by the processor to continue. (see also [http://en.wikipedia.org/wiki/Coroutine Wikipedia yield in coroutine]). Lua is able to yield execution.
			</p></dd></dl></div><div class="glossdiv"><h3 class="title">A</h3><dl><dt><a id="AAAA"></a><span class="glossterm"><acronym class="acronym">AAAA</acronym></span></dt><dd class="glossdef"><p>Acronym for Authentication, Authorization, Accounting and Auditing</p><p>See Also <a class="glossseealso" href="#Authentication">Authentication</a>, <a class="glossseealso" href="#Authorization">Authorization</a>, <a class="glossseealso" href="#Accounting">Accounting</a>, <a class="glossseealso" href="#Auditing">Auditing</a>.</p></dd><dt><a id="Authentication"></a><span class="glossterm">Authentication</span></dt><dd class="glossdef"><p>Some reasonable definition here. BTW, this just an example.</p><p>See Also <a class="glossseealso" href="#AAAA"><acronym class="acronym">AAAA</acronym></a>.</p></dd><dt><a id="Authorization"></a><span class="glossterm">Authorization</span></dt><dd class="glossdef"><p>Some reasonable definition here. BTW, this just an example.</p><p>See Also <a class="glossseealso" href="#AAAA"><acronym class="acronym">AAAA</acronym></a>.</p></dd><dt><a id="Accounting"></a><span class="glossterm">Accounting</span></dt><dd class="glossdef"><p>Some reasonable definition here. BTW, this just an example.</p><p>See Also <a class="glossseealso" href="#AAAA"><acronym class="acronym">AAAA</acronym></a>.</p></dd><dt><a id="Auditing"></a><span class="glossterm">Auditing</span></dt><dd class="glossdef"><p>Some reasonable definition here. BTW, this just an example.</p><p>See Also <a class="glossseealso" href="#AAAA"><acronym class="acronym">AAAA</acronym></a>.</p></dd></dl></div><div class="glossdiv"><h3 class="title">S</h3><dl><dt><a id="SSL"></a><span class="glossterm"><acronym class="acronym">SSL</acronym></span></dt><dd class="glossdef"><p>Secure Sockets Layer</p><p>Cryptographic protocols which provide secure communications on the Internet.
			SSL is a predecessor to TLS</p><p>See Also <a class="glossseealso" href="#TLS"><acronym class="acronym">TLS</acronym></a>.</p></dd></dl></div><div class="glossdiv"><h3 class="title">T</h3><dl><dt><a id="TLS"></a><span class="glossterm"><acronym class="acronym">TLS</acronym></span></dt><dd class="glossdef"><p>Transport Layer Security</p><p>Transport Layer Security (TLS) and its predecessor, Secure Sockets Layer (SSL),
			are cryptographic protocols that provide communication security over the Internet.
			TLS and SSL encrypt the segments of network connections above the Transport Layer,
			using asymmetric cryptography for key exchange, symmetric encryption for privacy,
			and message authentication codes for message integrity. [<span class="citation">Wikipedia</span>]</p><p>See Also <a class="glossseealso" href="#SSL"><acronym class="acronym">SSL</acronym></a>.</p></dd></dl></div></div><div class="index"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397291692"></a>Index</h1></div></div></div><div class="index"></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397296140"></a>Appendix A. Language Grammars</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="sect1"><a href="#idp1397337788">A.1. Grammars</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1397337788"></a>A.1. Grammars</h2></div></div></div><p>
			</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397295084"></a>.1. EBNF of the Transaction Definition Language</h3></div></div></div><table width="100%" cellpadding="5" bgcolor="#F5DCB3" border="1" class="productionset" summary="EBNF for Tokens"><tr><th align="left" valign="top" class="productionset">Tokens</th></tr><tr><td><table border="0" width="99%" cellpadding="0" bgcolor="#F5DCB3" class="productionset" summary="EBNF productions"><tr><td align="left" valign="top" width="3%">[1]</td><td align="right" valign="top" width="10%"><a id="Identifier"></a>Identifier</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( ['A'-'Z'] | ['a'-'z'] | ['0'-'9'] | '_' ) +
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[2]</td><td align="right" valign="top" width="10%"><a id="Number"></a>Number</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( ['0'-'9'] ) +
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[3]</td><td align="right" valign="top" width="10%"><a id="String"></a>String</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			  ( ['\'']([^'\''])+['\'']+ )
			| ( ['\"']([^'\"'])+['\"']+ )
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[4]</td><td align="right" valign="top" width="10%"><a id="Selection"></a>Selection</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			(
				( '/' | '//' | )
				( Identifier | '..' )
				( <a href="#Selection">Selection</a> | )
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[5]</td><td align="right" valign="top" width="10%"><a id="EmbeddedArg"></a>EmbeddedArg</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#String">String</a>
			|
				'$'
				( <a href="#Number">Number</a>
				| ( <a href="#Identifier">Identifier</a>
				| '(' <a href="#Selection">Selection</a> ')'
				| '[' <a href="#Identifier">Identifier</a> ']'
				)
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[6]</td><td align="right" valign="top" width="10%"><a id="FuncArg"></a>FuncArg</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#String">String</a>
			| <a href="#Selection">Selection</a>
			| <a href="#EmbeddedArg">EmbeddedArg</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[7]</td><td align="right" valign="top" width="10%"><a id="PreprcArg"></a>PreprcArg</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#String">String</a>
			| <a href="#Selection">Selection</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr></table></td></tr></table><table width="100%" cellpadding="5" bgcolor="#F5DCB3" border="1" class="productionset" summary="EBNF for Statements"><tr><th align="left" valign="top" class="productionset">Statements</th></tr><tr><td><table border="0" width="99%" cellpadding="0" bgcolor="#F5DCB3" class="productionset" summary="EBNF productions"><tr><td align="left" valign="top" width="3%">[8]</td><td align="right" valign="top" width="10%"><a id="Destination"></a>Destination</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			'INTO'
			<a href="#Identifier">Identifier</a>
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[9]</td><td align="right" valign="top" width="10%"><a id="Foreach"></a>Foreach</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			'FOREACH'
			<a href="#Selection">Selection</a>
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[10]</td><td align="right" valign="top" width="10%"><a id="EmbeddedOp"></a>EmbeddedOp</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			SQLStatement
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[11]</td><td align="right" valign="top" width="10%"><a id="FuncArgLst"></a>FuncArgLst</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#FuncArg">FuncArg</a> ','
				<a href="#FuncArgLst">FuncArgLst</a>
			|
				<a href="#FuncArg">FuncArg</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[12]</td><td align="right" valign="top" width="10%"><a id="NamedOp"></a>NamedOp</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			<a href="#Identifier">Identifier</a>
			'('
				( <a href="#FuncArgLst">FuncArgLst</a> | )
			')'
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[13]</td><td align="right" valign="top" width="10%"><a id="Action"></a>Action</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			'DO'
				(
					<a href="#EmbeddedOp">EmbeddedOp</a>
				|	<a href="#NamedOp">NamedOp</a>
				)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[14]</td><td align="right" valign="top" width="10%"><a id="Statement"></a>Statement</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#Destination">Destination</a> | )
			( <a href="#Foreach">Foreach</a> | )
			<a href="#Action">Action</a>
			';'
		</td><td align="left" valign="top" width="30%"> </td></tr></table></td></tr></table><table width="100%" cellpadding="5" bgcolor="#F5DCB3" border="1" class="productionset" summary="EBNF for Pre-Processing Commands"><tr><th align="left" valign="top" class="productionset">Pre-Processing Commands</th></tr><tr><td><table border="0" width="99%" cellpadding="0" bgcolor="#F5DCB3" class="productionset" summary="EBNF productions"><tr><td align="left" valign="top" width="3%">[15]</td><td align="right" valign="top" width="10%"><a id="PreprcArgLst"></a>PreprcArgLst</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#PreprcArg">PreprcArg</a> ','
				<a href="#PreprcArgLst">PreprcArgLst</a>
			|
				<a href="#PreprcArg">PreprcArg</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[16]</td><td align="right" valign="top" width="10%"><a id="PreprcOp"></a>PreprcOp</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			<a href="#Identifier">Identifier</a>
			'('
				( <a href="#PreprcArgLst">PreprcArgLst</a> | )
			')'
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[17]</td><td align="right" valign="top" width="10%"><a id="PreprcCall"></a>PreprcCall</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			'DO'
				(
					<a href="#PreprcOp">PreprcOp</a>
				)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[18]</td><td align="right" valign="top" width="10%"><a id="PreprcStm"></a>PreprcStm</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#Destination">Destination</a> | )
			( <a href="#Foreach">Foreach</a> | )
			<a href="#PreprcCall">PreprcCall</a>
			';'
		</td><td align="left" valign="top" width="30%"> </td></tr></table></td></tr></table><table width="100%" cellpadding="5" bgcolor="#F5DCB3" border="1" class="productionset" summary="EBNF for Transactions"><tr><th align="left" valign="top" class="productionset">Transactions</th></tr><tr><td><table border="0" width="99%" cellpadding="0" bgcolor="#F5DCB3" class="productionset" summary="EBNF productions"><tr><td align="left" valign="top" width="3%">[19]</td><td align="right" valign="top" width="10%"><a id="PreprcStmLst"></a>PreprcStmLst</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#PreprcStm">PreprcStm</a>
			| <a href="#PreprcStm">PreprcStm</a>
			  <a href="#PreprcStmLst">PreprcStmLst</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[20]</td><td align="right" valign="top" width="10%"><a id="PreprcBody"></a>PreprcBody</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			'BEGIN'
			<a href="#PreprcStmLst">PreprcStmLst</a>
			'END'
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[21]</td><td align="right" valign="top" width="10%"><a id="StatementLst"></a>StatementLst</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( <a href="#Statement">Statement</a>
			| <a href="#Statement">Statement</a>
			  <a href="#StatementLst">StatementLst</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[22]</td><td align="right" valign="top" width="10%"><a id="OpBody"></a>OpBody</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			'BEGIN'
			<a href="#StatementLst">StatementLst</a>
			'END'
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[23]</td><td align="right" valign="top" width="10%"><a id="Operation"></a>Operation</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			'OPERATION' <a href="#Identifier">Identifier</a>
			( 'RESULT' 'INTO' <a href="#Identifier">Identifier</a> | )
			<a href="#OpBody">OpBody</a>
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[24]</td><td align="right" valign="top" width="10%"><a id="Transaction"></a>Transaction</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			'TRANSACTION' <a href="#Identifier">Identifier</a>
			[
				'AUTHORIZE' '(' <a href="#Identifier">Identifier</a> ','
						<a href="#Identifier">Identifier</a> ')'
			]
			[	'PREPROCESS'
				<a href="#PreprcBody">PreprcBody</a>
			]
			[
				'RESULT' 'INTO' <a href="#Identifier">Identifier</a>
			]
			<a href="#OpBody">OpBody</a>
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[25]</td><td align="right" valign="top" width="10%"><a id="Program"></a>Program</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			(
			  <a href="#Transaction">Transaction</a>
			| <a href="#Operation">Operation</a>
			)
			(
			  <a href="#Program">Program</a>
			| )
		</td><td align="left" valign="top" width="30%"> </td></tr></table></td></tr></table></div><p>

			</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397457388"></a>.2. EBNF of the Normalizer Function Declarations</h3></div></div></div><p>The declaration of a type starts with an identifier followed by an assignment operator '='
		and a comma separated sequence of ':' separated identifier tuples, defining the name
		of the normalization module (1st) and the name of the function (2nd).
		The type declaration is closed with a semicolon ';'.</p><table width="100%" cellpadding="5" bgcolor="#F5DCB3" border="1" class="productionset" summary="EBNF for Tokens"><tr><th align="left" valign="top" class="productionset">Tokens</th></tr><tr><td><table border="0" width="99%" cellpadding="0" bgcolor="#F5DCB3" class="productionset" summary="EBNF productions"><tr><td align="left" valign="top" width="3%">[26]</td><td align="right" valign="top" width="10%"><a id="normIdentifier"></a>Identifier</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			( ['A'-'Z'] | ['a'-'z'] | ['0'-'9'] | '_' ) +
		</td><td align="left" valign="top" width="30%"> </td></tr></table></td></tr></table><table width="100%" cellpadding="5" bgcolor="#F5DCB3" border="1" class="productionset" summary="EBNF for Declarations"><tr><th align="left" valign="top" class="productionset">Declarations</th></tr><tr><td><table border="0" width="99%" cellpadding="0" bgcolor="#F5DCB3" class="productionset" summary="EBNF productions"><tr><td align="left" valign="top" width="3%">[27]</td><td align="right" valign="top" width="10%"><a id="normNamespace"></a>Namespace</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			<a href="#normIdentifier">Identifier</a>
			':'
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[28]</td><td align="right" valign="top" width="10%"><a id="normNormalizeCall"></a>Call</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			(
			  (
			    <a href="#normNamespace">Namespace</a>
			    <a href="#normIdentifier">Identifier</a>
			  )
			|
			  <a href="#normIdentifier">Identifier</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[29]</td><td align="right" valign="top" width="10%"><a id="normNormalizeSeq"></a>CallSeq</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			(
			  (
			    <a href="#normNormalizeCall">Call</a>
			    ','
			    <a href="#normNormalizeSeq">CallSeq</a>
			  )
			|
			  <a href="#normNormalizeCall">Call</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[30]</td><td align="right" valign="top" width="10%"><a id="normTypedef"></a>Typedef</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			<a href="#normIdentifier">Identifier</a>
			'='
			  <a href="#normNormalizeSeq">CallSeq</a>
			';'
		</td><td align="left" valign="top" width="30%"> </td></tr><tr><td align="left" valign="top" width="3%">[31]</td><td align="right" valign="top" width="10%"><a id="normProgram"></a>Program</td><td valign="top" width="5%" align="center"><code>::=</code></td><td valign="top" width="52%">
			(
			  (
			    <a href="#normTypedef">Typedef</a>
			    <a href="#normProgram">Program</a>
			  )
			|
			  <a href="#normTypedef">Typedef</a>
			)
		</td><td align="left" valign="top" width="30%"> </td></tr></table></td></tr></table></div><p>

		</p></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="gpl"></a>Appendix B. 
    <acronym class="acronym">GNU</acronym> General Public License version 3
  </h1></div></div></div><p>
    Version 3, 29 June 2007
  </p><p>
    Copyright © 2007 Free Software Foundation, Inc.
    <a class="ulink" href="http://fsf.org/" target="_top">http://fsf.org/</a>
  </p><p>
    Everyone is permitted to copy and distribute verbatim copies of this license
    document, but changing it is not allowed.
  </p><h2><a id="Preamble"></a>
    Preamble
  </h2><p>
    The <acronym class="acronym">GNU</acronym> General Public License is a free, copyleft
    license for software and other kinds of works.
  </p><p>
    The licenses for most software and other practical works are designed to
    take away your freedom to share and change the works.  By contrast, the
    <acronym class="acronym">GNU</acronym> General Public License is intended to guarantee your
    freedom to share and change all versions of a program—to make sure it
    remains free software for all its users.  We, the Free Software Foundation,
    use the <acronym class="acronym">GNU</acronym> General Public License for most of our
    software; it applies also to any other work released this way by its
    authors.  You can apply it to your programs, too.
  </p><p>
    When we speak of free software, we are referring to freedom, not price.  Our
    General Public Licenses are designed to make sure that you have the freedom
    to distribute copies of free software (and charge for them if you wish),
    that you receive source code or can get it if you want it, that you can
    change the software or use pieces of it in new free programs, and that you
    know you can do these things.
  </p><p>
    To protect your rights, we need to prevent others from denying you these
    rights or asking you to surrender the rights.  Therefore, you have certain
    responsibilities if you distribute copies of the software, or if you modify
    it: responsibilities to respect the freedom of others.
  </p><p>
    For example, if you distribute copies of such a program, whether gratis or
    for a fee, you must pass on to the recipients the same freedoms that you
    received.  You must make sure that they, too, receive or can get the source
    code.  And you must show them these terms so they know their rights.
  </p><p>
    Developers that use the <acronym class="acronym">GNU</acronym> <acronym class="acronym">GPL</acronym>
    protect your rights with two steps: (1) assert copyright on the software,
    and (2) offer you this License giving you legal permission to copy,
    distribute and/or modify it.
  </p><p>
    For the developers’ and authors’ protection, the
    <acronym class="acronym">GPL</acronym> clearly explains that there is no warranty for this
    free software.  For both users’ and authors’ sake, the
    <acronym class="acronym">GPL</acronym> requires that modified versions be marked as changed,
    so that their problems will not be attributed erroneously to authors of
    previous versions.
  </p><p>
    Some devices are designed to deny users access to install or run modified
    versions of the software inside them, although the manufacturer can do so.
    This is fundamentally incompatible with the aim of protecting users’
    freedom to change the software.  The systematic pattern of such abuse occurs
    in the area of products for individuals to use, which is precisely where it
    is most unacceptable.  Therefore, we have designed this version of the
    <acronym class="acronym">GPL</acronym> to prohibit the practice for those products.  If such
    problems arise substantially in other domains, we stand ready to extend this
    provision to those domains in future versions of the <acronym class="acronym">GPL</acronym>,
    as needed to protect the freedom of users.
  </p><p>
    Finally, every program is threatened constantly by software patents.  States
    should not allow patents to restrict development and use of software on
    general-purpose computers, but in those that do, we wish to avoid the
    special danger that patents applied to a free program could make it
    effectively proprietary.  To prevent this, the <acronym class="acronym">GPL</acronym>
    assures that patents cannot be used to render the program non-free.
  </p><p>
    The precise terms and conditions for copying, distribution and modification
    follow.
  </p><h2><a id="idp1397531812"></a>
    TERMS AND CONDITIONS
  </h2><h2><a id="Definitions"></a>
    0. Definitions.
  </h2><p>
    “This License” refers to version 3 of the <acronym class="acronym">GNU</acronym>
    General Public License.
  </p><p>
    “Copyright” also means copyright-like laws that apply to other
    kinds of works, such as semiconductor masks.
  </p><p>
    “The Program” refers to any copyrightable work licensed under
    this License.  Each licensee is addressed as “you”.
    “Licensees” and “recipients” may be individuals or
    organizations.
  </p><p>
    To “modify” a work means to copy from or adapt all or part of
    the work in a fashion requiring copyright permission, other than the making
    of an exact copy.  The resulting work is called a “modified
    version” of the earlier work or a work “based on” the
    earlier work.
  </p><p>
    A “covered work” means either the unmodified Program or a work
    based on the Program.
  </p><p>
    To “propagate” a work means to do anything with it that, without
    permission, would make you directly or secondarily liable for infringement
    under applicable copyright law, except executing it on a computer or
    modifying a private copy.  Propagation includes copying, distribution (with
    or without modification), making available to the public, and in some
    countries other activities as well.
  </p><p>
    To “convey” a work means any kind of propagation that enables
    other parties to make or receive copies.  Mere interaction with a user
    through a computer network, with no transfer of a copy, is not conveying.
  </p><p>
    An interactive user interface displays “Appropriate Legal
    Notices” to the extent that it includes a convenient and prominently
    visible feature that (1) displays an appropriate copyright notice, and (2)
    tells the user that there is no warranty for the work (except to the extent
    that warranties are provided), that licensees may convey the work under this
    License, and how to view a copy of this License.  If the interface presents
    a list of user commands or options, such as a menu, a prominent item in the
    list meets this criterion.
  </p><h2><a id="SourceCode"></a>
    1. Source Code.
  </h2><p>
    The “source code” for a work means the preferred form of the
    work for making modifications to it.  “Object code” means any
    non-source form of a work.
  </p><p>
    A “Standard Interface” means an interface that either is an
    official standard defined by a recognized standards body, or, in the case of
    interfaces specified for a particular programming language, one that is
    widely used among developers working in that language.
  </p><p>
    The “System Libraries” of an executable work include anything,
    other than the work as a whole, that (a) is included in the normal form of
    packaging a Major Component, but which is not part of that Major Component,
    and (b) serves only to enable use of the work with that Major Component, or
    to implement a Standard Interface for which an implementation is available
    to the public in source code form.  A “Major Component”, in this
    context, means a major essential component (kernel, window system, and so
    on) of the specific operating system (if any) on which the executable work
    runs, or a compiler used to produce the work, or an object code interpreter
    used to run it.
  </p><p>
    The “Corresponding Source” for a work in object code form means
    all the source code needed to generate, install, and (for an executable
    work) run the object code and to modify the work, including scripts to
    control those activities.  However, it does not include the work’s
    System Libraries, or general-purpose tools or generally available free
    programs which are used unmodified in performing those activities but which
    are not part of the work.  For example, Corresponding Source includes
    interface definition files associated with source files for the work, and
    the source code for shared libraries and dynamically linked subprograms that
    the work is specifically designed to require, such as by intimate data
    communication or control flow between those subprograms and other parts of
    the work.
  </p><p>
    The Corresponding Source need not include anything that users can regenerate
    automatically from other parts of the Corresponding Source.
  </p><p>
    The Corresponding Source for a work in source code form is that same work.
  </p><h2><a id="BasicPermissions"></a>
    2. Basic Permissions.
  </h2><p>
    All rights granted under this License are granted for the term of copyright
    on the Program, and are irrevocable provided the stated conditions are met.
    This License explicitly affirms your unlimited permission to run the
    unmodified Program.  The output from running a covered work is covered by
    this License only if the output, given its content, constitutes a covered
    work.  This License acknowledges your rights of fair use or other
    equivalent, as provided by copyright law.
  </p><p>
    You may make, run and propagate covered works that you do not convey,
    without conditions so long as your license otherwise remains in force.  You
    may convey covered works to others for the sole purpose of having them make
    modifications exclusively for you, or provide you with facilities for
    running those works, provided that you comply with the terms of this License
    in conveying all material for which you do not control copyright.  Those
    thus making or running the covered works for you must do so exclusively on
    your behalf, under your direction and control, on terms that prohibit them
    from making any copies of your copyrighted material outside their
    relationship with you.
  </p><p>
    Conveying under any other circumstances is permitted solely under the
    conditions stated below.  Sublicensing is not allowed; section 10 makes it
    unnecessary.
  </p><h2><a id="Protecting"></a>
    3. Protecting Users’ Legal Rights From Anti-Circumvention Law.
  </h2><p>
    No covered work shall be deemed part of an effective technological measure
    under any applicable law fulfilling obligations under article 11 of the WIPO
    copyright treaty adopted on 20 December 1996, or similar laws prohibiting or
    restricting circumvention of such measures.
  </p><p>
    When you convey a covered work, you waive any legal power to forbid
    circumvention of technological measures to the extent such circumvention is
    effected by exercising rights under this License with respect to the covered
    work, and you disclaim any intention to limit operation or modification of
    the work as a means of enforcing, against the work’s users, your or
    third parties’ legal rights to forbid circumvention of technological
    measures.
  </p><h2><a id="ConveyingVerbatim"></a>
    4. Conveying Verbatim Copies.
  </h2><p>
    You may convey verbatim copies of the Program’s source code as you
    receive it, in any medium, provided that you conspicuously and appropriately
    publish on each copy an appropriate copyright notice; keep intact all
    notices stating that this License and any non-permissive terms added in
    accord with section 7 apply to the code; keep intact all notices of the
    absence of any warranty; and give all recipients a copy of this License
    along with the Program.
  </p><p>
    You may charge any price or no price for each copy that you convey, and you
    may offer support or warranty protection for a fee.
  </p><h2><a id="ConveyingModified"></a>
    5. Conveying Modified Source Versions.
  </h2><p>
    You may convey a work based on the Program, or the modifications to produce
    it from the Program, in the form of source code under the terms of section
    4, provided that you also meet all of these conditions:
  </p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>
        The work must carry prominent notices stating that you modified it, and
        giving a relevant date.
      </p></li><li class="listitem"><p>
        The work must carry prominent notices stating that it is released under
        this License and any conditions added under section 7.  This requirement
        modifies the requirement in section 4 to “keep intact all
        notices”.
      </p></li><li class="listitem"><p>
        You must license the entire work, as a whole, under this License to
        anyone who comes into possession of a copy.  This License will therefore
        apply, along with any applicable section 7 additional terms, to the
        whole of the work, and all its parts, regardless of how they are
        packaged.  This License gives no permission to license the work in any
        other way, but it does not invalidate such permission if you have
        separately received it.
      </p></li><li class="listitem"><p>
        If the work has interactive user interfaces, each must display
        Appropriate Legal Notices; however, if the Program has interactive
        interfaces that do not display Appropriate Legal Notices, your work need
        not make them do so.
      </p></li></ol></div><p>
    A compilation of a covered work with other separate and independent works,
    which are not by their nature extensions of the covered work, and which are
    not combined with it such as to form a larger program, in or on a volume of
    a storage or distribution medium, is called an “aggregate” if
    the compilation and its resulting copyright are not used to limit the access
    or legal rights of the compilation’s users beyond what the individual works
    permit.  Inclusion of a covered work in an aggregate does not cause
    this License to apply to the other parts of the aggregate.
  </p><h2><a id="ConveyingNonSource"></a>
    6. Conveying Non-Source Forms.
  </h2><p>
    You may convey a covered work in object code form under the terms of
    sections 4 and 5, provided that you also convey the machine-readable
    Corresponding Source under the terms of this License, in one of these ways:
  </p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>
        Convey the object code in, or embodied in, a physical product (including
        a physical distribution medium), accompanied by the Corresponding Source
        fixed on a durable physical medium customarily used for software
        interchange.
      </p></li><li class="listitem"><p>
        Convey the object code in, or embodied in, a physical product (including
        a physical distribution medium), accompanied by a written offer, valid
        for at least three years and valid for as long as you offer spare parts
        or customer support for that product model, to give anyone who possesses
        the object code either (1) a copy of the Corresponding Source for all
        the software in the product that is covered by this License, on a
        durable physical medium customarily used for software interchange, for a
        price no more than your reasonable cost of physically performing this
        conveying of source, or (2) access to copy the Corresponding Source from
        a network server at no charge.
      </p></li><li class="listitem"><p>
        Convey individual copies of the object code with a copy of the written
        offer to provide the Corresponding Source.  This alternative is allowed
        only occasionally and noncommercially, and only if you received the
        object code with such an offer, in accord with subsection 6b.
      </p></li><li class="listitem"><p>
        Convey the object code by offering access from a designated place
        (gratis or for a charge), and offer equivalent access to the
        Corresponding Source in the same way through the same place at no
        further charge.  You need not require recipients to copy the
        Corresponding Source along with the object code.  If the place to copy
        the object code is a network server, the Corresponding Source may be on
        a different server (operated by you or a third party) that supports
        equivalent copying facilities, provided you maintain clear directions
        next to the object code saying where to find the Corresponding Source.
        Regardless of what server hosts the Corresponding Source, you remain
        obligated to ensure that it is available for as long as needed to
        satisfy these requirements.
      </p></li><li class="listitem"><p>
        Convey the object code using peer-to-peer transmission, provided you
        inform other peers where the object code and Corresponding Source of the
        work are being offered to the general public at no charge under
        subsection 6d.
      </p></li></ol></div><p>
    A separable portion of the object code, whose source code is excluded from
    the Corresponding Source as a System Library, need not be included in
    conveying the object code work.
  </p><p>
    A “User Product” is either (1) a “consumer product”,
    which means any tangible personal property which is normally used for
    personal, family, or household purposes, or (2) anything designed or sold
    for incorporation into a dwelling.  In determining whether a product is a
    consumer product, doubtful cases shall be resolved in favor of coverage.
    For a particular product received by a particular user, “normally
    used” refers to a typical or common use of that class of product,
    regardless of the status of the particular user or of the way in which the
    particular user actually uses, or expects or is expected to use, the
    product.  A product is a consumer product regardless of whether the product
    has substantial commercial, industrial or non-consumer uses, unless such
    uses represent the only significant mode of use of the product.
  </p><p>
    “Installation Information” for a User Product means any methods,
    procedures, authorization keys, or other information required to install and
    execute modified versions of a covered work in that User Product from a
    modified version of its Corresponding Source.  The information must suffice
    to ensure that the continued functioning of the modified object code is in
    no case prevented or interfered with solely because modification has been
    made.
  </p><p>
    If you convey an object code work under this section in, or with, or
    specifically for use in, a User Product, and the conveying occurs as part of
    a transaction in which the right of possession and use of the User Product
    is transferred to the recipient in perpetuity or for a fixed term
    (regardless of how the transaction is characterized), the Corresponding
    Source conveyed under this section must be accompanied by the Installation
    Information.  But this requirement does not apply if neither you nor any
    third party retains the ability to install modified object code on the User
    Product (for example, the work has been installed in
    <acronym class="acronym">ROM</acronym>).
  </p><p>
    The requirement to provide Installation Information does not include a
    requirement to continue to provide support service, warranty, or updates for
    a work that has been modified or installed by the recipient, or for the User
    Product in which it has been modified or installed.  Access to a network may
    be denied when the modification itself materially and adversely affects the
    operation of the network or violates the rules and protocols for
    communication across the network.
  </p><p>
    Corresponding Source conveyed, and Installation Information provided, in
    accord with this section must be in a format that is publicly documented
    (and with an implementation available to the public in source code form),
    and must require no special password or key for unpacking, reading or
    copying.
  </p><h2><a id="AdditionalTerms"></a>
     7. Additional Terms.
   </h2><p>
     “Additional permissions” are terms that supplement the terms of
     this License by making exceptions from one or more of its conditions.
     Additional permissions that are applicable to the entire Program shall be
     treated as though they were included in this License, to the extent that
     they are valid under applicable law.  If additional permissions apply only
     to part of the Program, that part may be used separately under those
     permissions, but the entire Program remains governed by this License
     without regard to the additional permissions.
   </p><p>
     When you convey a copy of a covered work, you may at your option remove any
     additional permissions from that copy, or from any part of it.  (Additional
     permissions may be written to require their own removal in certain cases
     when you modify the work.)  You may place additional permissions on
     material, added by you to a covered work, for which you have or can give
     appropriate copyright permission.
   </p><p>
     Notwithstanding any other provision of this License, for material you add
     to a covered work, you may (if authorized by the copyright holders of that
     material) supplement the terms of this License with terms:
   </p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>
         Disclaiming warranty or limiting liability differently from the terms
         of sections 15 and 16 of this License; or
       </p></li><li class="listitem"><p>
         Requiring preservation of specified reasonable legal notices or author
         attributions in that material or in the Appropriate Legal Notices
         displayed by works containing it; or
       </p></li><li class="listitem"><p>
         Prohibiting misrepresentation of the origin of that material, or
         requiring that modified versions of such material be marked in
         reasonable ways as different from the original version; or
       </p></li><li class="listitem"><p>
         Limiting the use for publicity purposes of names of licensors or
         authors of the material; or
       </p></li><li class="listitem"><p>
         Declining to grant rights under trademark law for use of some trade
         names, trademarks, or service marks; or
       </p></li><li class="listitem"><p>
         Requiring indemnification of licensors and authors of that material by
         anyone who conveys the material (or modified versions of it) with
         contractual assumptions of liability to the recipient, for any
         liability that these contractual assumptions directly impose on those
         licensors and authors.
       </p></li></ol></div><p>
     All other non-permissive additional terms are considered “further
     restrictions” within the meaning of section 10.  If the Program as
     you received it, or any part of it, contains a notice stating that it is
     governed by this License along with a term that is a further restriction,
     you may remove that term.  If a license document contains a further
     restriction but permits relicensing or conveying under this License, you
     may add to a covered work material governed by the terms of that license
     document, provided that the further restriction does not survive such
     relicensing or conveying.
   </p><p>
     If you add terms to a covered work in accord with this section, you must
     place, in the relevant source files, a statement of the additional terms
     that apply to those files, or a notice indicating where to find the
     applicable terms.
   </p><p>
     Additional terms, permissive or non-permissive, may be stated in the form
     of a separately written license, or stated as exceptions; the above
     requirements apply either way.
   </p><h2><a id="Termination"></a>
     8. Termination.
   </h2><p>
     You may not propagate or modify a covered work except as expressly provided
     under this License.  Any attempt otherwise to propagate or modify it is
     void, and will automatically terminate your rights under this License
     (including any patent licenses granted under the third paragraph of section
     11).
   </p><p>
     However, if you cease all violation of this License, then your license from
     a particular copyright holder is reinstated (a) provisionally, unless and
     until the copyright holder explicitly and finally terminates your license,
     and (b) permanently, if the copyright holder fails to notify you of the
     violation by some reasonable means prior to 60 days after the cessation.
   </p><p>
     Moreover, your license from a particular copyright holder is reinstated
     permanently if the copyright holder notifies you of the violation by some
     reasonable means, this is the first time you have received notice of
     violation of this License (for any work) from that copyright holder, and
     you cure the violation prior to 30 days after your receipt of the notice.
   </p><p>
     Termination of your rights under this section does not terminate the
     licenses of parties who have received copies or rights from you under this
     License.  If your rights have been terminated and not permanently
     reinstated, you do not qualify to receive new licenses for the same
     material under section 10.
   </p><h2><a id="AcceptanceNotRequired"></a>
     9. Acceptance Not Required for Having Copies.
   </h2><p>
     You are not required to accept this License in order to receive or run a
     copy of the Program.  Ancillary propagation of a covered work occurring
     solely as a consequence of using peer-to-peer transmission to receive a
     copy likewise does not require acceptance.  However, nothing other than
     this License grants you permission to propagate or modify any covered work.
     These actions infringe copyright if you do not accept this License.
     Therefore, by modifying or propagating a covered work, you indicate your
     acceptance of this License to do so.
   </p><h2><a id="AutomaticDownstream"></a>
     10. Automatic Licensing of Downstream Recipients.
   </h2><p>
     Each time you convey a covered work, the recipient automatically receives a
     license from the original licensors, to run, modify and propagate that
     work, subject to this License.  You are not responsible for enforcing
     compliance by third parties with this License.
   </p><p>
     An “entity transaction” is a transaction transferring control
     of an organization, or substantially all assets of one, or subdividing an
     organization, or merging organizations.  If propagation of a covered work
     results from an entity transaction, each party to that transaction who
     receives a copy of the work also receives whatever licenses to the work the
     party’s predecessor in interest had or could give under the previous
     paragraph, plus a right to possession of the Corresponding Source of the
     work from the predecessor in interest, if the predecessor has it or can get
     it with reasonable efforts.
   </p><p>
     You may not impose any further restrictions on the exercise of the rights
     granted or affirmed under this License.  For example, you may not impose a
     license fee, royalty, or other charge for exercise of rights granted under
     this License, and you may not initiate litigation (including a cross-claim
     or counterclaim in a lawsuit) alleging that any patent claim is infringed
     by making, using, selling, offering for sale, or importing the Program or
     any portion of it.
   </p><h2><a id="Patents"></a>
    11. Patents.
  </h2><p>
    A “contributor” is a copyright holder who authorizes use under
    this License of the Program or a work on which the Program is based.  The
    work thus licensed is called the contributor’s “contributor
    version”.
  </p><p>
    A contributor’s “essential patent claims” are all patent
    claims owned or controlled by the contributor, whether already acquired or
    hereafter acquired, that would be infringed by some manner, permitted by
    this License, of making, using, or selling its contributor version, but do
    not include claims that would be infringed only as a consequence of further
    modification of the contributor version.  For purposes of this definition,
    “control” includes the right to grant patent sublicenses in a
    manner consistent with the requirements of this License.
  </p><p>
    Each contributor grants you a non-exclusive, worldwide, royalty-free patent
    license under the contributor’s essential patent claims, to make, use,
    sell, offer for sale, import and otherwise run, modify and propagate the
    contents of its contributor version.
  </p><p>
    In the following three paragraphs, a “patent license” is any
    express agreement or commitment, however denominated, not to enforce a
    patent (such as an express permission to practice a patent or covenant not
    to sue for patent infringement).  To “grant” such a patent
    license to a party means to make such an agreement or commitment not to
    enforce a patent against the party.
  </p><p>
    If you convey a covered work, knowingly relying on a patent license, and the
    Corresponding Source of the work is not available for anyone to copy, free
    of charge and under the terms of this License, through a publicly available
    network server or other readily accessible means, then you must either (1)
    cause the Corresponding Source to be so available, or (2) arrange to deprive
    yourself of the benefit of the patent license for this particular work, or
    (3) arrange, in a manner consistent with the requirements of this License,
    to extend the patent license to downstream recipients.  “Knowingly
    relying” means you have actual knowledge that, but for the patent
    license, your conveying the covered work in a country, or your
    recipient’s use of the covered work in a country, would infringe one
    or more identifiable patents in that country that you have reason to believe
    are valid.
  </p><p>
    If, pursuant to or in connection with a single transaction or arrangement,
    you convey, or propagate by procuring conveyance of, a covered work, and
    grant a patent license to some of the parties receiving the covered work
    authorizing them to use, propagate, modify or convey a specific copy of the
    covered work, then the patent license you grant is automatically extended to
    all recipients of the covered work and works based on it.
  </p><p>
    A patent license is “discriminatory” if it does not include
    within the scope of its coverage, prohibits the exercise of, or is
    conditioned on the non-exercise of one or more of the rights that are
    specifically granted under this License.  You may not convey a covered work
    if you are a party to an arrangement with a third party that is in the
    business of distributing software, under which you make payment to the third
    party based on the extent of your activity of conveying the work, and under
    which the third party grants, to any of the parties who would receive the
    covered work from you, a discriminatory patent license (a) in connection
    with copies of the covered work conveyed by you (or copies made from those
    copies), or (b) primarily for and in connection with specific products or
    compilations that contain the covered work, unless you entered into that
    arrangement, or that patent license was granted, prior to 28 March 2007.
  </p><p>
    Nothing in this License shall be construed as excluding or limiting any
    implied license or other defenses to infringement that may otherwise be
    available to you under applicable patent law.
  </p><h2><a id="NoSurrender"></a>
    12. No Surrender of Others’ Freedom.
  </h2><p>
    If conditions are imposed on you (whether by court order, agreement or
    otherwise) that contradict the conditions of this License, they do not
    excuse you from the conditions of this License.  If you cannot convey a
    covered work so as to satisfy simultaneously your obligations under this
    License and any other pertinent obligations, then as a consequence you may
    not convey it at all.  For example, if you agree to terms that obligate you
    to collect a royalty for further conveying from those to whom you convey the
    Program, the only way you could satisfy both those terms and this License
    would be to refrain entirely from conveying the Program.
  </p><h2><a id="UsedWithAGPL"></a>
    13. Use with the <acronym class="acronym">GNU</acronym> Affero General Public License.
  </h2><p>
    Notwithstanding any other provision of this License, you have permission to
    link or combine any covered work with a work licensed under version 3 of the
    <acronym class="acronym">GNU</acronym> Affero General Public License into a single combined
    work, and to convey the resulting work.  The terms of this License will
    continue to apply to the part which is the covered work, but the special
    requirements of the <acronym class="acronym">GNU</acronym> Affero General Public License,
    section 13, concerning interaction through a network will apply to the
    combination as such.
  </p><h2><a id="RevisedVersions"></a>
    14. Revised Versions of this License.
  </h2><p>
    The Free Software Foundation may publish revised and/or new versions of the
    <acronym class="acronym">GNU</acronym> General Public License from time to time.  Such new
    versions will be similar in spirit to the present version, but may differ in
    detail to address new problems or concerns.
  </p><p>
    Each version is given a distinguishing version number.  If the Program
    specifies that a certain numbered version of the <acronym class="acronym">GNU</acronym>
    General Public License “or any later version” applies to it, you
    have the option of following the terms and conditions either of that
    numbered version or of any later version published by the Free Software
    Foundation.  If the Program does not specify a version number of the
    <acronym class="acronym">GNU</acronym> General Public License, you may choose any version
    ever published by the Free Software Foundation.
  </p><p>
    If the Program specifies that a proxy can decide which future versions of
    the <acronym class="acronym">GNU</acronym> General Public License can be used, that
    proxy’s public statement of acceptance of a version permanently
    authorizes you to choose that version for the Program.
  </p><p>
    Later license versions may give you additional or different permissions.
    However, no additional obligations are imposed on any author or copyright
    holder as a result of your choosing to follow a later version.
  </p><h2><a id="WarrantyDisclaimer"></a>
    15. Disclaimer of Warranty.
  </h2><p>
    THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE
    LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR
    OTHER PARTIES PROVIDE THE PROGRAM “AS IS” WITHOUT WARRANTY OF
    ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE
    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
    THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH
    YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL
    NECESSARY SERVICING, REPAIR OR CORRECTION.
  </p><h2><a id="LiabilityLimitation"></a>
    16. Limitation of Liability.
  </h2><p>
    IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL
    ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS THE
    PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
    GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE
    OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA
    OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
    PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),
    EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
    SUCH DAMAGES.
  </p><h2><a id="InterpretationSecs1516"></a>
    17. Interpretation of Sections 15 and 16.
  </h2><p>
    If the disclaimer of warranty and limitation of liability provided above
    cannot be given local legal effect according to their terms, reviewing
    courts shall apply local law that most closely approximates an absolute
    waiver of all civil liability in connection with the Program, unless a
    warranty or assumption of liability accompanies a copy of the Program in
    return for a fee.
  </p><h2><a id="idp1397601668"></a>
    END OF TERMS AND CONDITIONS
  </h2><h2><a id="HowToApply"></a>
    How to Apply These Terms to Your New Programs
  </h2><p>
    If you develop a new program, and you want it to be of the greatest possible
    use to the public, the best way to achieve this is to make it free software
    which everyone can redistribute and change under these terms.
  </p><p>
    To do so, attach the following notices to the program.  It is safest to
    attach them to the start of each source file to most effectively state the
    exclusion of warranty; and each file should have at least the
    “copyright” line and a pointer to where the full notice is
    found.
  </p><pre class="screen">
<em class="replaceable"><code>one line to give the program’s name and a brief idea of what it does.</code></em>
Copyright (C) <em class="replaceable"><code>year</code></em> <em class="replaceable"><code>name of author</code></em>

This program is free software: you can redistribute it and/or modify
it under the terms of the <acronym class="acronym">GNU</acronym> General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
<acronym class="acronym">GNU</acronym> General Public License for more details.

You should have received a copy of the <acronym class="acronym">GNU</acronym> General Public License
along with this program.  If not, see <a class="ulink" href="http://www.gnu.org/licenses/" target="_top">http://www.gnu.org/licenses/</a>.
  </pre><p>
    Also add information on how to contact you by electronic and paper mail.
  </p><p>
    If the program does terminal interaction, make it output a short notice like
    this when it starts in an interactive mode:
  </p><pre class="screen">
<em class="replaceable"><code>program</code></em> Copyright (C) <em class="replaceable"><code>year</code></em> <em class="replaceable"><code>name of author</code></em>
This program comes with ABSOLUTELY NO WARRANTY; for details type ‘<code class="literal">show w</code>’.
This is free software, and you are welcome to redistribute it
under certain conditions; type ‘<code class="literal">show c</code>’ for details.
  </pre><p>
    The hypothetical commands ‘<code class="literal">show w</code>’ and
    ‘<code class="literal">show c</code>’ should show the appropriate parts of
    the General Public License.  Of course, your program’s commands might be
    different; for a GUI interface, you would use an “about box”.
  </p><p>
    You should also get your employer (if you work as a programmer) or school,
    if any, to sign a “copyright disclaimer” for the program, if
    necessary.  For more information on this, and how to apply and follow the
    <acronym class="acronym">GNU</acronym> <acronym class="acronym">GPL</acronym>, see
    <a class="ulink" href="http://www.gnu.org/licenses/" target="_top">http://www.gnu.org/licenses/</a>.
  </p><p>
    The <acronym class="acronym">GNU</acronym> General Public License does not permit
    incorporating your program into proprietary programs.  If your program is a
    subroutine library, you may consider it more useful to permit linking
    proprietary applications with the library.  If this is what you want to do,
    use the <acronym class="acronym">GNU</acronym> Lesser General Public License instead of this
    License.  But first, please read <a class="ulink" href="http://www.gnu.org/philosophy/why-not-lgpl.html" target="_top">http://www.gnu.org/philosophy/why-not-lgpl.html</a>.
  </p></div></div><div xml:lang="en" class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="book_Client"></a>Wolframe Clients</h1></div><div><h2 class="subtitle">Clients to access Wolframe</h2></div><div><p class="copyright">Copyright © 2010 - 2013 Project Wolframe</p></div><div><div class="legalnotice"><a id="idp1396038924"></a><p><strong>Commercial Usage. </strong>
	    Licensees holding valid Project Wolframe Commercial licenses may
	    use this file in accordance with the Project Wolframe
	    Commercial License Agreement provided with the Software or,
	    alternatively, in accordance with the terms contained
	    in a written agreement between the licensee and Project Wolframe.
	</p><p><strong>GNU General Public License Usage. </strong>
	    Alternatively, you can redistribute this file and/or modify it
	    under the terms of the <acronym class="acronym">GNU</acronym> General Public License as published by
	    the Free Software Foundation, either version 3 of the License, or
	    (at your option) any later version.
	</p><p>
    Wolframe is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    <acronym class="acronym">GNU</acronym> General Public License for more details.
</p><p>
    You should have received a copy of the GNU General Public License
    along with Wolframe.  If not, see
    <a class="ulink" href="http://www.gnu.org/licenses/" target="_top"><em class="citetitle">http://www.gnu.org/licenses/</em></a>
</p><p>
    If you have questions regarding the use of this file, please contact
    Project Wolframe.
</p></div></div><div><p class="pubdate">October 31, 2013
 version 0.0.3
</p></div></div><hr /></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="chapter"><a href="#idp1397664372">1. Introduction</a></span></dt><dt><span class="chapter"><a href="#idp1397696108">2. Presentation Tier</a></span></dt><dd><dl><dt><span class="sect1"><a href="#idp1397693900">2.1. Wolframe Standard Client (wolfclient)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397694220">2.1.1. Architecture</a></span></dt><dt><span class="sect2"><a href="#idp1397748348">2.1.2. Artifacts</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397749396">UI forms</a></span></dt><dt><span class="sect3"><a href="#idp1397751028">UI form translations</a></span></dt><dt><span class="sect3"><a href="#idp1397754884">Resources</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1397756508">2.1.3. Programming the Interface</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397759292">Mapping XML Data</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1397759612">Starting Position</a></span></dt><dt><span class="sect4"><a href="#idp1397760796">First Example</a></span></dt><dt><span class="sect4"><a href="#idp1397768188">Another Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1397776228">Switching UI forms</a></span></dt><dt><span class="sect3"><a href="#idp1397781140">States and properties of widgets</a></span></dt><dt><span class="sect3"><a href="#idp1397782748">Widget properties as dynamic property values</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1397784116">2.1.4. Eliminating Interface Defects</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397785252">Switch the Developer Mode On</a></span></dt><dt><span class="sect3"><a href="#idp1397788420">Inspect Errors and Warnings and Debug Messages Reported</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="index"><a href="#idp1397815028">Index</a></span></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397664372"></a>Chapter 1. Introduction</h1></div></div></div><p>This part of the manual describes how the user interface part (presentation tier, also called client) of
	<span class="application">Wolframe</span> applications can be built.
	</p><p>A <span class="application">Wolframe</span> client can be of various kinds. They all communicate with the server over
	a text based protocol in a plain or encrypted session. All methods used are based on open standards.
	</p><p>We will introduce two examples of clients: The <span class="application">Wolframe</span> standard client and a web client
	communicating via a web server with the <span class="application">Wolframe</span> application server.
	</p><p>
	After reading this chapter you should be able to create a <span class="application">Wolframe</span> client based of one of these
	two examples on your own.
	</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397696108"></a>Chapter 2. Presentation Tier</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="sect1"><a href="#idp1397693900">2.1. Wolframe Standard Client (wolfclient)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#idp1397694220">2.1.1. Architecture</a></span></dt><dt><span class="sect2"><a href="#idp1397748348">2.1.2. Artifacts</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397749396">UI forms</a></span></dt><dt><span class="sect3"><a href="#idp1397751028">UI form translations</a></span></dt><dt><span class="sect3"><a href="#idp1397754884">Resources</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1397756508">2.1.3. Programming the Interface</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397759292">Mapping XML Data</a></span></dt><dd><dl><dt><span class="sect4"><a href="#idp1397759612">Starting Position</a></span></dt><dt><span class="sect4"><a href="#idp1397760796">First Example</a></span></dt><dt><span class="sect4"><a href="#idp1397768188">Another Example</a></span></dt></dl></dd><dt><span class="sect3"><a href="#idp1397776228">Switching UI forms</a></span></dt><dt><span class="sect3"><a href="#idp1397781140">States and properties of widgets</a></span></dt><dt><span class="sect3"><a href="#idp1397782748">Widget properties as dynamic property values</a></span></dt></dl></dd><dt><span class="sect2"><a href="#idp1397784116">2.1.4. Eliminating Interface Defects</a></span></dt><dd><dl><dt><span class="sect3"><a href="#idp1397785252">Switch the Developer Mode On</a></span></dt><dt><span class="sect3"><a href="#idp1397788420">Inspect Errors and Warnings and Debug Messages Reported</a></span></dt></dl></dd></dl></dd></dl></div><p>This chapter describes the presentation tier and how a <span class="application">Wolframe</span> user interface is built.
</p><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp1397693900"></a>2.1. Wolframe Standard Client (wolfclient)</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397694220"></a>2.1.1. Architecture</h3></div></div></div><p>
		The <span class="application">Wolframe</span> standard client <span class="application">wolfclient</span>
		is a thin client which executes XML requests
		via the Wolframe protocol and presents XML answers. It is written in
		Qt and is cross-platform. Qt is currently available on
		<a class="ulink" href="http://doc.qt.digia.com/qt/index.html" target="_top"><em class="citetitle">http://doc.qt.digia.com/qt/index.html</em></a>.
		User interfaces for <span class="application">wolfclient</span> are defined as a set of forms
		using standard Qt widgets and are if ever possible defined using the
		<span class="application">Qt Interface Designer</span> (see <a class="ulink" href="http://qt-project.org/doc/qt-4.8/designer-manual.html" target="_top"><em class="citetitle">http://qt-project.org/doc/qt-4.8/designer-manual.html</em></a>).
	</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397748348"></a>2.1.2. Artifacts</h3></div></div></div><p>
		The <span class="application">wolfclient</span> renders user interface forms dynamically,
		this means no code generation or compilation is involved when creating
		user interfaces for Wolframe.
	</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397749396"></a>UI forms</h4></div></div></div><p>
			The UI files follow the schema
			'qt-ui-4.7.xsd', as documented in
			<a class="ulink" href="http://doc.qt.digia.com/qt/designer-ui-file-format.html" target="_top"><em class="citetitle">http://doc.qt.digia.com/qt/designer-ui-file-format.html</em></a>.
			The UI files have the extension <span class="emphasis"><em>.ui</em></span>
		</p><p>
			UI files are created and edited with the Qt designer.
		</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397751028"></a>UI form translations</h4></div></div></div><p>
			The <span class="application">wolfclient</span> uses the Qt translation format, version 2.0 for form translations
			as described in
			<a class="ulink" href="http://doc.qt.digia.com/qt/linguist-ts-file-format.html" target="_top"><em class="citetitle">http://doc.qt.digia.com/qt/linguist-ts-file-format.html</em></a>.
			Those are the files with extension <span class="emphasis"><em>.ts</em></span>.
		</p><p>
			The translation files can get merged and generated with the <span class="emphasis"><em>lupdate</em></span>
			tool, then translated with the <span class="emphasis"><em>Qt Linguist</em></span>.
		</p><p>
			The Qt client needs the files in compiled form as files with the extension
			<span class="emphasis"><em>.qm</em></span>. The <span class="emphasis"><em>lupdate</em></span> tool is taking
			care of that.
		</p><p>
			Read more on translations in
			<a class="ulink" href="http://doc.qt.digia.com/qt/linguist-manual.html" target="_top"><em class="citetitle">http://doc.qt.digia.com/qt/linguist-manual.html</em></a>.
		</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397754884"></a>Resources</h4></div></div></div><p>
			Binary resource files contain images for the user interface.
		</p><p>
			Binary resource files (extension <span class="emphasis"><em>.rss</em></span>) are compiled from
			a XML file (extension <span class="emphasis"><em>.qrc</em></span>) with the <span class="emphasis"><em>rcc</em></span>
			resource compiler.
		</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397756508"></a>2.1.3. Programming the Interface</h3></div></div></div><p>
			Programming means we annotate the XML of the UI form files with
			some extra properties. They control the following things:
			</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
					Which events in the current form replace it with a new form,
					e. g. clicking the <span class="emphasis"><em>Edit</em></span> button loads
					the form called <span class="emphasis"><em>edit_item</em></span>.
				</p></li><li class="listitem"><p>
					When and how requests to the Wolframe server should be sent
					and how the results should be interpreted when adding data
					to the widgets, e.g. executing a <span class="emphasis"><em>save item request</em></span>
					with all the data in the text fields of the form added to the request
					XML.
				</p></li></ul></div><p>
		</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397759292"></a>Mapping XML Data</h4></div></div></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1397759612"></a>Starting Position</h5></div></div></div><p>For mapping data structures from the user interface elements to the
				data description needed to fulfill an interface for a server request we need
				some kind of translation. An implicit mapping would only be able to describe
				very trivial data mappings. After drawing the user interface this translation
				has to be defined. On the other hand the requests answer returned by the server
				has to be mapped to be shown in the user interface elements view. Here applies
				the same: Some kind of translation is needed to map a server data structure
				to the user interface elements.
				</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1397760796"></a>First Example</h5></div></div></div><p>
					Let's have a look at a <code class="classname">QLineEdit</code>
					element of a form and a possible XML representation of the
					data used for a request.
				</p><div class="screenshot"><div class="mediaobject"><img src="images/clients/simple_form.png" /></div></div><pre class="programlisting">
				
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;!DOCTYPE customer SYSTEM 'Customer'&gt;
&lt;customer&gt;
  &lt;name&gt;John Smith&lt;/name&gt;
  &lt;address&gt;Blue Police Box&lt;/address&gt;
&lt;/customer&gt;

				</pre><p>
					For an insert or update request that transmits all data of the form to the
					server we have to fill the name field and the address field into the request
					data structure XML.
					The translation is defined as dynamic property "action" or "action." plus a suffix for the action identifier
					if needed. We will explain this naming of actions later. The
					value of the property is describing the request and could look as follows:
				</p><pre class="programlisting">
				update: Customer customer {name{{main.name}}; address{{main.address}}}

				</pre><p>
					For the initial filling of the form with data we submit a
					request that just sends an id to the server.
					The answer that is returned by the server has then to be
					translated to fill the name field and the address field
					of the form.
					The translation is defined as dynamic property "answer"
					or "answer." plus a suffix for the action identifier.
					As in the request example we postpone a detailed explanation
					of this action naming semantics.
					The value of the property is describing the answer
					in the same language as a request and could look as follows:
				</p><pre class="programlisting">
				Customer customer {name{{main.name}}; address{{main.address}}}

				</pre></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idp1397768188"></a>Another Example</h5></div></div></div><p>
					Some elements are more complicated than that.
					They present the user a list of options or items the user to pick from, e.g. a list of cities.
				</p><div class="screenshot"><div class="mediaobject"><img src="images/clients/complex_form.png" /></div></div><p>
					When the form is saved, the currently selected element is written into
					the resulting XML:
				</p><pre class="programlisting">
				
&lt;customer&gt;
  &lt;name&gt;John Smith&lt;/name&gt;
  &lt;address&gt;Blue Police Box&lt;/address&gt;
  &lt;city&gt;6&lt;/city&gt;
&lt;/customer&gt;

				</pre><p>
					In this case the widget with the city list can load its own domain data as a separate
					XML request:
				</p><pre class="programlisting">
				
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE city SYSTEM 'CityListRequest'&gt;
&lt;cities/&gt;

				</pre><p>
					and the corresponding domain load request answer definition in the dynamic property "answer"
					could look like follows:
				</p><pre class="programlisting">
				CityList cities {city[] {id={main.city.id}; {main.city.value}}}

				</pre><p>
					The answer contains all possible values in the domain, in our case
					a list of all cities and their internal id.
				</p><pre class="programlisting">
				
&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;!DOCTYPE "cities" SYSTEM "CityList"&gt;
&lt;cities&gt;
&lt;city id='1'&gt;Tokyo&lt;/city&gt;
&lt;city id='2'&gt;Lima&lt;/city&gt;
&lt;city id='3'&gt;Beijing&lt;/city&gt;
&lt;city id='4'&gt;Cairo&lt;/city&gt;
&lt;city id='5'&gt;Tehran&lt;/city&gt;
&lt;city id='6'&gt;London&lt;/city&gt;
&lt;/cities&gt;

				</pre></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397776228"></a>Switching UI forms</h4></div></div></div><p>
				A UI form contains a set of widgets, the dynamic property
				<code class="code">form</code> contains the name of a widget (without
				extension <span class="emphasis"><em>.ui</em></span>) to load.
			</p><p>
				For linking a push <code class="classname">QPushButton</code> click in the Qt designer
				to the switching of the form you have to attach a dynamic property
				named <code class="code">form</code>	of type <code class="code">string</code> to the corresponding
				widget of type <code class="classname">QPushButton</code>:

				</p><div class="screenshot"><div class="mediaobject"><img src="images/clients/action_on_pushbutton.png" /></div></div><p>

			</p><p>
				Before loading the next form the client terminates all current
				requests, for instance a save request of the form data.
				In case of an error in an action any defined switching of the form is cancelled.
			</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397781140"></a>States and properties of widgets</h4></div></div></div><p>
				Some properties are reserved for states steering the behavior of the user interface:

				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="code">initialFocus</code>:
					This is a thing which got forgotten in the Qt design.
					We can set a boolean value to one widget in a form which should
					get the initial keyboard focus.
					</p></li></ul></div><p>
			</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397782748"></a>Widget properties as dynamic property values</h4></div></div></div><p>
				Dynamic properties can reference properties of widgets
				like for example <code class="code">property = {variable expression}</code>.
			</p><p>
				The expression can reference addressable widgets and their properties.
				Every Qt class has its very own set of properties it understands.
			</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idp1397784116"></a>2.1.4. Eliminating Interface Defects</h3></div></div></div><p>
			Functional defects in the user interface like for example syntax errors in the
			definitions of the request answer can be eliminated by inspecting the error messages
			reported by the <span class="application">wolfclient</span> in developer mode
			and fixing the interface accordingly.
		</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397785252"></a>Switch the Developer Mode On</h4></div></div></div><p>In order to inspect the internals of your client program, we have first
			to switch on "Developer Mode" in the "Developer" context of the "Preferences Dialog".
			The following picture emphasizes the check box you have to enable (highlighted green).
			</p><div class="screenshot"><div class="mediaobject"><img src="images/clients/preferences_developper_develmode.png" /></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idp1397788420"></a>Inspect Errors and Warnings and Debug Messages Reported</h4></div></div></div><p>To inspect internal messages reported by the <span class="application">wolfclient</span>
			in developer mode we have to open the debug window.
			The debug window is opened by clicking on the bug icon in the
			main tool bar or via the developer context menu. The following picture
			shows an example debug output. Each action we do from now on with
			the debug window opened can be followed on the level of messages it emits.
			</p><p>
			We can see the messages in the message list when clicking on the
			"Refresh" button. The navigation allows us to restrict our focus 
			on messages on a node in the object tree by clicking on it. 
			Clicking on the root node shows all messages in the recent history.
			The history starts with the last main node created
			before opening the debug window. All message restrictions
			show the messages in order of their emission. We can restrict also on
			the severity of messages in the severity level selection (the select
			box set to "Debug" as default left of the "Refresh" button).
			</p><p>
			The "Clear" button allows us to empty the recent history without closing
			the debug window.
			</p><div class="screenshot"><div class="mediaobject"><img src="images/clients/debug_window.png" /></div></div></div></div></div></div><div class="index"><div class="titlepage"><div><div><h1 class="title"><a id="idp1397815028"></a>Index</h1></div></div></div><div class="index"></div></div></div></div></body></html>